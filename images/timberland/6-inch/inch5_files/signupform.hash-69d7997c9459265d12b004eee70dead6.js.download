define(["jquery","pubsub","datalayer.cms.signupform"],function(a,s){function t(s,e){this.element=s,this.messageDisplay=a(this.element).find(".signup-message.hide"),this.options=e,this.metadata=a(this.element).data("signupform-options")}var i="signupForm";t.defaults=(t.prototype={defaults:{successMessage:"Thank you for signing up.",errorMessage:"There was a problem. Please try again later.",alreadySubscribedMessage:"Sorry, this address already exists."},init:function(){console.log("initilizing form for",a(this.element)),this.config=a.extend({},this.defaults,this.options,this.metadata),this._build();var e=this;return a(e.element).on("submit",function(s){s.preventDefault()}),a(e.element).on("formvalid.zf.abide",function(){a.ajax({url:a(this).attr("action"),type:a(this).attr("method"),data:a(this).serialize(),processData:!0,cache:!1,success:function(s){console.log("form response",s),void 0!==s.errorMessage?(e.showResult(e.getErrorMessage(s),"alert"),e.publishSignupResult(!1)):(e.showResult(e.config.successMessage,"success"),e.publishSignupResult(!0,s))},error:function(s){console.log("form error",s),e.showResult(e.config.errorMessage,"alert"),e.publishSignupResult(!1)}})}),e},_build:function(){},getErrorMessage:function(s){return"UserAlreadySubscribed"===s.errorMessage?this.config.alreadySubscribedMessage:s.errorMessage},showResult:function(s,e){var t=this;a(t.messageDisplay).addClass("hide"),a(t.messageDisplay).find(".callout").remove(),a(t.messageDisplay).append("<div data-closable class='callout "+e+"'><span>"+s+"</span><a data-close class='close'>&times;</a>"),a(t.messageDisplay).removeClass("hide")},publishSignupResult:function(s,e){var t={result:s,response:e};a.pubsub("publish","vfdp.aem.footer.emailsignup",t)}}).defaults,a.fn.signupForm=function(e){return this.each(function(){var s=a(this).data(i);s||(s=new t(this,e).init(),a(this).data(i,s))})}});
//# sourceMappingURL=../../maps/js/cms/signupform.hash-c4f0fb8b159d6f42b6ed3f15c06b6224.js.map