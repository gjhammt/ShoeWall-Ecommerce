define(["jquery","cms.signupform","foundation.dropdown","handlebars-core","shared.main.screen","foundation.util.keyboard"],function(e,o,n,t,i){function a(e,o){this.element=$(e),this.options=o,this.data={},this.metadata=$(this.element).data("footer-options")}var r="footer";a.prototype={defaults:{columnContent:".column-content",columnHeader:".footer_col .heading",regionSelector:".footer-localize",regionSelectorButton:"#footer-region-button",regionSelectorDropdown:"#footer-region-dropdown",template:"html.cms.region-selector-list"},init:function(){console.log("Initializing footer component."),this.config=$.extend({},this.defaults,this.options,this.metadata);var e=this;return e.$footerContent=$(e.element).find(".footer-content > div"),e.$columnContent=e.$footerContent.find(e.config.columnContent),e.$columnHeaders=e.$footerContent.find(e.config.columnHeader),e.$regionSelector=$(this.element).find(e.config.regionSelector),e.$regionSelectorButton=e.$regionSelector.find(e.config.regionSelectorButton),e.$regionSelectorDropdown=e.$regionSelector.find(e.config.regionSelectorDropdown),e._build(),e._events(),$(this.element).find("form.signup").signupForm(),0<e.$regionSelectorButton.length&&e._loadRegionSelector(),e},_build:function(){var e=this;"small"===i.size()?(e._collapseAllMenus(),e.bindMobileEvents()):(e._expandAllMenus(),e.unbindMobileEvents())},_events:function(){var n=this;$.pubsub("subscribe","window.resize.breakpoint",function(e,o){n._build()});var o=$("#footerLinkModal");n.$columnContent.find("a[data-open][data-modal-size]").on("click",function(){var e=$(this).data("modalSize");o.attr("class","reveal "+e)}),$(n.element).find(".anchor-top").on("click.back-to-top",function(e){e.preventDefault(),window.scrollTo(0,0),$("a.topnav-logo, .store-logo a").focus()})},unbindMobileEvents:function(){this.$footerContent.off("click keydown")},bindMobileEvents:function(e){var a=this;a.$footerContent.on("click",function(){var e=$(this),o=e.find(a.config.columnHeader),n=e.find(a.config.columnContent),t=e.hasClass("collapsed");"small"===i.size()&&(t?(e.removeClass("collapsed"),n.removeClass("hide").attr({"aria-hidden":"false"}),o.attr({"aria-expanded":"true"})):(e.addClass("collapsed"),n.addClass("hide").attr({"aria-hidden":"true"}),o.attr({"aria-expanded":"false"})))}),a.toggleKeyboardMenuEvents(a.$footerContent)},toggleKeyboardMenuEvents:function(e){var o=this;e.off("keydown",o,o.keydownHandler),"small"===i.size()&&e.on("keydown",o,o.keydownHandler)},keydownHandler:function(e){var o=$(this),n=$(e.target),t=o.find(".heading"),a=o.find("a"),i=40,r=13,l=27,s=32,d=38;switch(e.keyCode){case s:case r:n.hasClass("heading")&&o.click();break;case i:if(n.hasClass("heading")&&(e.preventDefault(),a.first().focus()),n.is("a")){e.preventDefault();var c=n.parent().next().find("a");c.length||(c=a.first()),c.focus()}break;case d:if(n.is("a")){e.preventDefault();var f=n.parent().prev().find("a");f.length||(f=a.last()),f.focus()}break;case l:o.hasClass("collapsed")||t.click().focus()}},_expandAllMenus:function(){var e=this;e.$footerContent.removeClass("collapsed"),e.$columnContent.removeClass("hide").attr({"aria-hidden":null}),e.$columnHeaders.attr({"aria-expanded":null,"aria-haspopup":null,role:null,tabindex:"null"})},_collapseAllMenus:function(){var e=this;e.$footerContent.addClass("collapsed"),e.$columnContent.addClass("hide").attr({"aria-hidden":"true"}),e.$columnHeaders.attr({"aria-expanded":"false","aria-haspopup":"true",role:"button",tabindex:"0"})},_loadRegionSelector:function(){var o=this;o.data=o.$regionSelectorButton.data("regions"),o.$regionSelectorButton.one("click",function(e){o.loadAndCompileTemplate().done(function(){o._renderRegionSelector()})})},_renderRegionSelector:function(){var e=this;e.$regionSelectorDropdown.html(e.compiledTemplate(e.data)),new Foundation.Dropdown(e.$regionSelectorDropdown),e.$regionSelectorDropdown.foundation("open")}},a.prototype=$.extend({},t,a.prototype),a.defaults=a.prototype.defaults,$.fn.footer=function(o){return this.each(function(){var e=$(this).data(r);e||(e=new a(this,o).init(),$(this).data(r,e))})}});
//# sourceMappingURL=../../maps/js/cms/footer.hash-6f534c085ee3b85459ac63efafcc4e5b.js.map