define(["jquery","pubsub","wcs.context"],function(n,t,o){n.pubsub("unsubscribe",this.newColorwayProductEventToken),this.newColorwayProductEventToken=n.pubsub("subscribe","WCS.PRODUCTFORM.COLORWAY_PRODUCT.NEW",function(t,e){new r(e.object.data("product-id"))});var r=function(t){this.productDrawerId="#product_details_drawer_container_"+t,this.catentryId=t,this.init()};r.prototype={init:function(){var t=this;0===n(t.productDrawerId).length||!0===WCS_CONFIG.get("PDP::pdpFormServerUpdateEnabled")?t.doProductDrawerAjax():t.changeDrawerContent()},convert:function(t){return n("<span />",{html:t}).text()},attachProductFeaturesHandlers:function(){var t=this;n(".show-more-features-js").on("click",function(){t.toggleMultipleProductFeatures(this)}),n(".product-feature-button-js").on("click",function(){t.toggleSingleProductFeature(this)})},toggleSingleProductFeature:function(t){n(t).closest("ul.feature .product-feature-js").find(".show-more-separator, .show-more, .flex-video").fadeToggle()},toggleMultipleProductFeatures:function(t){n(t).closest("ul.feature").find(".more-features-js").slideToggle("slow",function(){n(".show-more-features-js").fadeOut()})},handleProductDrawerAjaxDataReturn:function(t){var e=this,r="<div class='hidden' id='product_details_drawer_container_"+e.catentryId+"'></div>";if(n(".product-details-drawer-container").after(r),n(e.productDrawerId).data("productLongDescription",e.convert(t.productLongDescription)),n(e.productDrawerId).data("additionalProductDescription",e.convert(t.additionalProductDescription)),n(e.productDrawerId).data("mainFeature",e.convert(t.mainFeature)),n(e.productDrawerId).data("productFeature",e.convert(t.productFeature)),WCS_CONFIG.get("PDP::pdpFormServerUpdateEnabled")&&t.productForm){var o=n(".product-form-wrapper");o.first().html(t.productForm),n.pubsub("publish","WCS.PRODUCTFORM.COLORWAY_PRODUCT.FORM_UPDATE",{updatedForm:o.find("form")})}e.changeDrawerContent()},changeDrawerContent:function(){var t=this;n("#drawer_description_content_long_description").html(n(t.productDrawerId).data("productLongDescription")),n("#drawer_description_main_feature").html(n(t.productDrawerId).data("mainFeature")),n("#drawer_description_product_feature").html(n(t.productDrawerId).data("productFeature")),t.populateProductDetailsDrawerList(),t.attachProductFeaturesHandlers()},populateProductDetailsDrawerList:function(){var t,e=n(this.productDrawerId).data("additionalProductDescription"),r=WCS_CONFIG.PDP.productDescriptionListDelimiter,o=e?e.split(r):[],a=0<o.length&&""!==o[0],d=n("<"+WCS_CONFIG.PDP.productDescriptionListContainerTag+">");if(n("#drawer_description_content_additional_description").addClass("hidden"),a){for(i=0;i<o.length;i++)(t=n("<"+WCS_CONFIG.PDP.productDescriptionListItemTag+">")).html(o[i]),d.append(t);n("#drawer_description_content_additional_description").removeClass("hidden"),n("#drawer_description_content_additional_description").html(d)}},doProductDrawerAjax:function(){var e=this,t="pdp"===n("body").data("pageType")?"pdp":"quickview",r={productId:e.catentryId,storeId:o.getStoreId(),langId:o.getLangId(),catalogId:o.getCatalogId(),view:t};0<n(".shopcart-update-js").length&&(r.view="edit"),n.ajax({url:o.getURLWithContextRoot("VFProductDrawerJSONView"),data:r,context:this,dataType:"json",cache:!0,async:!0}).done(function(t){e.handleProductDrawerAjaxDataReturn(t)})}}});
//# sourceMappingURL=../../../../maps/js/wcs/view/product-form/product-form-drawer.hash-d4bab884a68a3c729a21edada4eb53e2.js.map