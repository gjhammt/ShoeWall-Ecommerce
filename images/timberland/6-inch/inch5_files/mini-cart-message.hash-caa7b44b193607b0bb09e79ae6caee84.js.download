define(["jquery","pubsub","wcs.context","Handlebars","handlebars-core","state-manager","promise!wcs.lang-msg"],function(o,e,s,t,i,r){"use strict";function a(e,t){return this.pluginID=n,this.element=e,this.$element=o(this.element),this.options=t||{},this.state=new r,this.storeId=s.getStoreId(),this.mobileCheckoutButtonEnabled=WCS_CONFIG.get("PDP::pdpMobileCTACheckoutEnabled"),this.mobileShippingButtonEnabled=WCS_CONFIG.get("PDP::pdpMobileCTAShippingEnabled"),this.mobileApplePayButtonEnabled=WCS_CONFIG.get("applePay::applePayPDPMobileCTAEnabled"),this.wishlistURL=o(".add-to-wishlist-js").data("wishlist-url"),this.shopcartURL=o(".btn-shoppingbag-js, .topnav-cart a").attr("href"),this.shopcartButtonText=WCS_CONFIG.get("PDP::pdpMobileCTAButtonText"),this.checkoutButtonText=LANG_MSG["MOBILE_SHOP_CART.MSG.successfullyAdded3"],this.mobileGenericMessage=WCS_CONFIG.get("global::miniCartMobileGenericMessage"),this}var n="minicartMessage";a.prototype={defaults:{messages:{successAddToCartMessage:LANG_MSG["MOBILE_SHOP_CART.MSG.successfullyAdded"],successAddToCartMessage2:LANG_MSG["MOBILE_SHOP_CART.MSG.successfullyAdded2"],successAddToCartMessage3:LANG_MSG["MOBILE_SHOP_CART.MSG.successfullyAdded3"],successAddToCartMessage4:LANG_MSG["MOBILE_SHOP_CART.MSG.successfullyAdded4"],successAddToWishlistMessage:LANG_MSG["MOBILE_WISH_LIST.MSG.successfullyAdded"],successAddToWishlistMessage2:LANG_MSG["MOBILE_WISH_LIST.MSG.successfullyAdded2"],successAddToWishlistMessage3:LANG_MSG["MOBILE_WISH_LIST.MSG.successfullyAdded3"],removeFromWishlistMessage:LANG_MSG["DEFAULT_MINICART.MSG.removedFromWishlist"],removeFromCartMessage:LANG_MSG["DEFAULT_MINICART.MSG.removedFromShoppingCart"],closeText:LANG_MSG["MODAL.LABELS.CLOSE"]},template:"html.mini-cart.messaging",wishlistPanelNotification:"#wishlist-notification-panel .notification",cartPanelNotification:".global-cart-wishlist-panels-js .notification, .topnav-minicart-panel .notification"},init:function(){var e=this;return this.config=o.extend(!0,{},this.defaults,this.options,this.metadata),this.loadAndCompileTemplate().done(function(){e.events()}),this},events:function(){var i=this;o.pubsub("subscribe","ORDER_ID_UPDATED",function(e,t){i.state.setProperty({orderId:t.orderId})}),o.pubsub("subscribe","SHOPCART_UPDATED.add",function(e,t){t=t||{},i.$element=o(i.config.cartPanelNotification),i.checkoutURL="VFShippingAddressView?orderId="+i.state.getProperty("orderId")+"&storeId="+i.storeId,i.cartItemCount=s.getShoppingCart().quantity,i.state.setProperty({productName:t.product[0].name}).setProperty({shopcart:!0}).setProperty({genericMessageEnabled:i.mobileGenericMessage}).setProperty({shopcartURL:i.shopcartURL}).setProperty({checkoutURL:i.checkoutURL}).setProperty({cartItemCount:i.cartItemCount}).setProperty({shopcartButtonText:i.shopcartButtonText}).setProperty({checkoutButtonText:i.checkoutButtonText}).setProperty({mobileShippingButtonEnabled:i.mobileShippingButtonEnabled}).setProperty({mobileCheckoutButtonEnabled:i.mobileCheckoutButtonEnabled}).setProperty({mobileApplePayButtonEnabled:i.mobileApplePayButtonEnabled}),t.disableMiniCart||i.render()}),o.pubsub("subscribe","SHOPCART_UPDATED.remove",function(e,t){i.$element=o(i.config.cartPanelNotification),i.state.setProperty({message:i.config.messages.removeFromCartMessage}).setProperty({removeItem:!0}),i.render()}),o.pubsub("subscribe","WISHLIST_UPDATED.remove",function(e,t){var s=!0;t.product&&t.product.length&&void 0!==t.product[0].showMiniCartMsg&&!1===t.product[0].showMiniCartMsg&&(s=!1),s&&(i.$element=o(i.config.cartPanelNotification),i.state.setProperty({message:i.config.messages.removeFromWishlistMessage}).setProperty({removeItem:!0}),i.render())}),o.pubsub("subscribe","vfdp.wcs.product_form.add_to_wishlist_succeeded",function(e,t){i.$element=o(i.config.wishlistPanelNotification),i.state.setProperty({wishlist:!0}).setProperty({productName:t.productName}).setProperty({wishlistURL:i.wishlistURL}),i.render()})},render:function(){return this.state.setProperty({config:this.config}),this.$element.html(this.compiledTemplate(this.state.getState())),this.state.clearState(),this}},a.defaults=a.prototype.defaults,a.prototype=o.extend({},i,a.prototype),o.fn.minicartMessage=function(t){return this.each(function(){var e=o(this).data(n);e||(e=new a(this,t).init(),o(this).data(n,e))})}});
//# sourceMappingURL=../../../maps/js/wcs/view/mini-cart-message.hash-c62851550348155f81fe5beff61bf8fc.js.map