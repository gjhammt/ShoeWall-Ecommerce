define(["jquery","pubsub","vfdp.speechRecognitionView"],function(o,n){function i(n,e){this.element=n,this.options=e}var t="speechRecognition";i.defaults=(i.prototype={defaults:{grammar:"#JSGF V1.0",continuous:!1,interimResults:!1,maxAlternatives:1,weight:1,lang:"en"},init:function(){var n=this;return n.metadata=o(n.element).data(t+"Options"),n.config=o.extend({},n.defaults,n.options,n.metadata),n.isSpeechRecognitionEnabled()?(o.pubsub("publishSync","vfdp.speechrecognition.subscribe"),n.enableSpeechRecognition(),n.events()):o.pubsub("publish","vfdp.speechrecognition.unsubscribe"),n},events:function(){var i=this;i.recognition.onstart=function(){o.pubsub("publish","vfdp.speechrecognition.start")},i.recognition.onresult=function(n){var e=n.results.length-1,i=n.results[e][0].transcript;o.pubsub("publish","vfdp.speechrecognition.result",{search:i})},i.recognition.onspeechend=function(){i.recognition.stop(),o.pubsub("publish","vfdp.speechrecognition.end")},i.recognition.onnomatch=function(n){o.pubsub("publish","vfdp.speechrecognition.nomatch",{error:n.error})},i.recognition.onerror=function(n){o.pubsub("publish","vfdp.speechrecognition.error",{error:n.error})},o.pubsub("subscribe","vfdp.speechrecognitionview.searchTriggered",function(n,e){i.recognition.abort()}),o.pubsub("subscribe","vfdp.speechrecognitionview.click",function(n,e){i.startSpeechRecognition()})},isSpeechRecognitionEnabled:function(){return"SpeechRecognition"in window||"webkitSpeechRecognition"in window},enableSpeechRecognition:function(){var n=this,e=window.SpeechRecognition||window.webkitSpeechRecognition,i=window.SpeechGrammarList||window.webkitSpeechGrammarList;n.recognition=new e;var t=new i;t.addFromString(n.config.grammar,n.config.weight),n.recognition.grammars=t,n.recognition.continuous=n.config.continuous,n.recognition.lang=n.getCurrentLanguage(),n.recognition.interimResults=n.config.interimResults,n.recognition.maxAlternatives=n.config.maxAlternatives,o.pubsub("publish","vfdp.speechrecognition.enabled",{options:n.config})},startSpeechRecognition:function(){this.recognition.start()},getCurrentLanguage:function(){return o("html").attr("lang")||this.config.lang}}).defaults,o.fn[t]=function(e){return this.each(function(){var n=o(this).data(t);n||(n=new i(this,e).init(),o(this).data(t,n))})}});
//# sourceMappingURL=../../../maps/js/vfdp/ui/speechRecognition.hash-31094f9ca4454cd343bdc91cc93229c0.js.map