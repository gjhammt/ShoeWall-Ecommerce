define(["jquery","domReady","shared.main.screen","wcs.product-form-util","pubsub"],function(g,t,a){var e="PDPSwatchesEvents",l=g("body.pdp-drawer, .quickview-box.pdp-drawer").length||!1,r=!0===WCS_CONFIG.get("PDP::pdpUpdatePriceOnColorSwatchHover"),m=!0===WCS_CONFIG.get("PDP::pdpUpdateColorTextOnHoverDisabled"),i=WCS_CONFIG.get("PDP::pdpUseInlineErrorEnabled")||!1,n=WCS_CONFIG.get("PDP::pdpDefaultSelectOnRegularSizeButton")||!1,o=!1,s=function(t){return this instanceof s?(this.productForm=g(t),this.productFormIndex=g(".product-form-js").index(this.productForm),this):new s(t)};s.prototype={initPDPSwatchesEvents:function(){return this.globalEvents(),this.PDPSwatchesEvents(),this},globalEvents:function(){var e=this;g(document).on("QUICKSHOP_DISPLAY","REFRESH_PRODUCT_AVAILABILITY",function(t){e.PDPSwatchesEvents()}),g.pubsub("subscribe","WCS.PRODUCTFORM.COLORWAY_PRODUCT.FORM_UPDATE",function(){e.PDPSwatchesEvents()})},isSizeButtonClick:function(t){return g(t.currentTarget).hasClass("product-content-form-size-btn-label")},PDPSwatchesEvents:function(){var s=this,a=this.touchType=window.navigator.pointerEnabled?"pointer":"ontouchstart"in window?"touch":"mouse";this.productForm.find("select").off("change"),this.productForm.find("select").on("change",function(t){g.pubsub("publish","WCS.PRODUCTFORM.ATTRIBUTE.CHANGE"),s.handleSelectAttributeChange(t),s.resetFormErrors()}),this.productForm.find(".attr-box").not(".context-trigger-js, .bl-attr-box").on({click:function(t){t.preventDefault();var e={target:t.currentTarget};s.handleFormClick(e,s),g.pubsub("publish","WCS.PRODUCTFORM.COLORWAY_PRODUCT.UPDATE",data={formIndex:s.productFormIndex,object:g(e.target)}),g.pubsub("publish","WCS.PDPSWATCHES.PRODUCTFORM.EVENT.FORMCLICK",!0),g.pubsub("publish","PDP_ADD_TO_CART_SELECTED",e)},mouseenter:function(t){var e={target:t.currentTarget};if("touch"==a)return!1;0<g("body.catalog.bundle, body.catalog.bundle-detail-page-js").length||m&&!s.isSizeButtonClick(t)||(s.handlePDPSwatchesAttributeSelection(e,s,{updateItemPrice:r,originateFromClick:!1}),g.pubsub("publish","WCS.PRODUCTFORM.EVENT.ATTR.MOUSE.ENTER",g(e.target)))},mouseleave:function(t){var e={target:t.currentTarget};if("touch"==a)return!1;0<g("body.catalog.bundle, body.catalog.bundle-detail-page-js").length||m&&!s.isSizeButtonClick(t)||(s.handleFormMouseLeave(e),g.pubsub("publish","WCS.PRODUCTFORM.EVENT.ATTR.MOUSE.LEAVE",g(e.target)))},focus:function(t){var e={target:t.currentTarget};s.handlePDPSwatchesAttributeSelection(e,s,{updateItemPrice:r,originateFromClick:!1}),g.pubsub("publish","WCS.PRODUCTFORM.EVENT.ATTR.MOUSE.ENTER",g(e.target))},blur:function(t){var e={target:t.currentTarget};s.handleFormMouseLeave(e),g.pubsub("publish","WCS.PRODUCTFORM.EVENT.ATTR.MOUSE.LEAVE",g(e.target))}}),l&&(g(".step-container.attr-size").on("click",".attr-box",function(t){var e={target:t.currentTarget};if(s.handleFormClick(e,s),0===g(".step-content-width").find(t.currentTarget).length)s.lastSelectedSize=t.currentTarget,s.lastSelectedValue=g(t.currentTarget).data("attributeValue");else{var a=g(t.currentTarget).data("attributeValue");a!==s.lastSelectedWidthValue&&(s.lastSelectedWidthValue=a,g.pubsub("publish","WCS.PDPSWATCHES.PRODUCTFORM.EVENT.SIZESELECTED",{lastSelectedWidthValue:s.lastSelectedWidthValue}))}}),this.productForm.find(".attr-box").not(".context-trigger-js").off("mouseenter mouseleave focus blur"));var t=g(".color-swatches-js .attr-box").not(".bl-attr-box");t.on("click",function(t,e){var a="[data-variation-id]",r=t.currentTarget,i={target:r},n={target:g(a,r).addBack(a,r)[0]};e&&(n=g.extend({},n,e)),l&&s.newColorWayProductEvent(n,s),g.pubsub("publish","product-form.attr.swatch.click",n),g.pubsub("publish","WCS.PDPSWATCHES.PRODUCTFORM.EVENT.FORMCLICK"),s.handlePDPSwatchClick(i,s)}),this.pdpSwatchesWindowResizeEventToken=g.pubsub("subscribe","window.resize",function(){s._handleWindowResize()}),g(".pdp-swatches .product-details-js > h3").on("click",s._handleProductDetailsJSClick),g(".age-verify-js").on("click",function(){t.trigger("click")}),n&&g.pubsub("subscribe","WCS.PRODUCTFORM.PRESELECTED_VALUES.INIT",function(t,e){if(!e&&!o){o=!0;var a=g(".attr-size.selection-js").find('.attr-box.large[data-attribute-value="Regular"]');0<a.length&&a.click()}}),g.pubsub("subscribe","WCS.PRODUCTFORM.PRESELECTED_VALUES.INIT",function(t,e){var a=WCS_CONFIG.get("PDP::pdpFormUpdateDefaultSelectionL1");if(s.lastSelectedWidthValue&&a){var r=g(".attr-size.selection-js").find('button:not(.clicked)button:not(.out-of-stock).attr-box[data-attribute-value="'+s.lastSelectedWidthValue+'"]');0<r.length&&r.click()}if(s.lastSelectedSize&&s.lastSelectedValue&&a){var i=g(".attr-size.selection-js").find('button:not(.clicked).attr-box[data-attribute-value="'+s.lastSelectedValue+'"]');0<i.length&&i.click()}})},handleSelectAttributeChange:function(t){var e,a,r,i,n=g(t.target).find(":selected").eq(0),s=n.attr("data-attribute-value")||n.parent().attr("data-attribute-value");if(n.hasClass("attr-size-deselected-js")&&g.productFormUtil.resetSizeOptions(n,this.productFormIndex),!s)return!1;e=n.parents(".selection-js"),a=n.data("attribute-value")?n:n.parent(),r=e.attr("data-attribute-id"),i=a.attr("data-color-identifier")||a.attr("data-attribute-value"),n.siblings().removeClass("selected"),n.addClass("selected"),e.toggleClass("attribute-value-selected",!0),g.pubsub("publish","WCS.PRODUCTFORM.ATTRIBUTE.CHANGE.COMPLETE",data={obj:n,attribute:r,attributeValue:i,formIndex:this.productFormIndex})},handleFormClick:function(t,e){var a=g(t.target);a.parent(".attr-container-js").find(".attr-box").removeClass("selected clicked"),a.addClass("selected clicked"),e.handlePDPSwatchesAttributeSelection(t,e,{originateFromClick:!0}),i&&e.handleHideInlineErrorMessageOnAttributeChange(a)},handleFormMouseLeave:function(t){var e=g(t.target),a=null,r=e.parents(".selection-js"),i="";if(a=(e=e.attr("data-role")?e.parent():e).siblings(".clicked"),!e.hasClass("clicked"))if(a.addClass("selected"),e.removeClass("selected"),a.length){i=a.data("attributeValue");var n=a.data("colorIdentifier"),s=a.data("subAttributeValue");i&&r.find(".attribute-label-value-js").html(i),n&&r.find(".attr-selected-color-identifier").html("("+n+")"),s&&r.find(".sub-attr-selected-js").html(s)}else e.parents(".selection-js").removeClass("attribute-value-selected"),r.find(".attribute-label-value-js").html("")},handleHideInlineErrorMessageOnAttributeChange:function(t){t.parents(".attr-size.selection-js").find(".select-size-error-js").addClass("hide")},_handleProductDetailsJSClick:function(t){var e=g(this);"small"===a.size()&&(e.parent().children(".inner-content").slideToggle("fast"),e.children("span").toggleClass("open"))},_handleWindowResize:function(){var t=g.productFormUtil.getScrollbarSize();g(window).width();g(".pdp-swatches").length&&"small"!==a.size()&&(g(".product-details-js .inner-content").css("display","block"),g(".product-details-js h3 span").removeClass("open"))},handlePDPSwatchesAttributeSelection:function(t,e,a){var r,i,n,s,l,o,u,d,c,b,h=g(t.target);if(e.resetFormErrors(t),"undefined"!==h.data("attribute-value")||"undefined"!==h.parent().data("attribute-value")){r=h.parents(".selection-js"),l=(i="undefined"!==h.data("attribute-value")?h:h.parent()).attr("data-color-identifier"),o=i.attr("data-sub-attribute-value"),u=i.attr("data-attribute-long-value"),d=i.attr("data-attribute-conversion-value"),n=r.attr("data-attribute-id"),s=l||i.attr("data-attribute-value"),c=i.attr("data-attribute-stock"),b=g(".social-media-share-modal-subheading");var p=r.find(".attribute-label-value-js");d?p.html(d):(u?p.html(u):m&&!a.originateFromClick||p.html(i.data("attribute-value")),r.find(".attribute-label-separator-js").show(),l&&!g(".full-attr-color-select").length&&r.find(".attr-selected-color-identifier").html(" ("+l+")"),o?(r.find(".sub-attr-name").show(),r.find(".sub-attr-selected").html(o)):r.find(".sub-attr-name").hide()),r.find(".step-content .selected").removeClass("selected"),i.toggleClass("selected",!0),"OPTION"!==i.prop("tagName")&&(r.find(".attr-container input:checked").prop("checked",!1),r.find("#"+i.data("formButton")).prop("checked",!0));var C=i.find("img").data("productName");b.length&&C&&b.html(C),r.toggleClass("attribute-value-selected",!0);var f={obj:h,formIndex:this.productFormIndex,attribute:n,attributeValue:s,itemStockAttributeValue:c,updateItemPrice:!0};a&&(f=g.extend({},f,a)),g.pubsub("publish","WCS.PRODUCTFORM.ATTRIBUTE.CHANGE.COMPLETE",f)}},resetFormErrors:function(){g(".select-quantity-error-js",this.productForm).addClass("hide"),g("#qty-step-container",this.productForm).removeClass("error"),this.resetCartErrors()},resetCartErrors:function(){g.productFormUtil.clearAddTOCartErrorMessage(this.productForm)},handlePDPSwatchClick:function(t,e){var a=g(t.target);a.addClass("clicked").siblings().removeClass("clicked");var r=a.find(".color-swatch-button-content").data("modelMeasurement"),i="";r&&(i=r.replace(/\$\$/g,"<br/>"),i+="<br/>"),this.productForm.find(".model-measurements-text").html(i),e.handlePDPSwatchesAttributeSelection(t,e,{originateFromClick:!0})},newColorWayProductEvent:function(t,e){var a=g(t.target),r=a.data("productId");r&&g("input[name=catEntryId]").val(r),g.pubsub("publish","WCS.PRODUCTFORM.COLORWAY_PRODUCT.NEW",data={formIndex:e.productFormIndex,object:a})}},g.fn.PDPSwatchesEvents=function(){return this.each(function(){var t=g(this).data(e);t||(t=new s(this).initPDPSwatchesEvents(),g(this).data(e,t))})}});
//# sourceMappingURL=../../../../maps/js/wcs/view/product-form/product-form-pdpswatches-events.hash-da485cda5f8d2fb58ca9cf2bfcc84ba2.js.map