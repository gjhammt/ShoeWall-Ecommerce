/*!************************************************************************
*
* ADOBE CONFIDENTIAL
* ___________________
*
*  Copyright 2011 Adobe Systems Incorporated
*  All Rights Reserved.
*
* NOTICE:  All information contained herein is, and remains
* the property of Adobe Systems Incorporated and its suppliers,
* if any.  The intellectual and technical concepts contained
* herein are proprietary to Adobe Systems Incorporated and its
* suppliers and are protected by trade secret or copyright law.
* Dissemination of this information or reproduction of this material
* is strictly forbidden unless prior written permission is obtained
* from Adobe Systems Incorporated.
**************************************************************************/
(function(c){c.pkg("s7sdk.video");c.Util.require("s7sdk.common.ItemDesc");c.Util.require("s7sdk.common.IS");c.Util.require("s7sdk.common.IconEffect");c.Util.require("s7sdk.common.Enumeration");c.Util.require("s7sdk.common.WebVtt");c.Util.require("s7sdk.event.Event");if(!c.video.VideoPlayerControl){c.video.VideoPlayerControl=function(h){arguments.callee.superclass.apply(this,[h,c.video.VideoPlayerControl.NS,h.constructor,c.video.VideoPlayer.RESTRICTED_STYLES]);delete this.dynamicModifiers.posterimage};c.video.VideoPlayerControl.NS="s7sdk.video.VideoPlayerControl";c.video.VideoPlayerControl.prototype.setModifier=function(p){var h;for(var n in p){var j=n.toLowerCase();if(j=="navigation"){value=p[n];if(value){var m,l=true;prevVal=this.component.navigation.file+","+(this.component.enableNavigation?"1":"0");var o=value.split(",");if(o&&o.length>0){m=o[0];if(o.length>1){l=parseInt(o[1])!=0}if(m&&m.length>0){this.component.setNavigation(m,l);this.dispatchEvent(new c.event.ControlComponentEvent(c.event.ControlComponentEvent.NOTF_CONTROLCOMPONENT_MODIFIERUPDATED,{id:this.component.getId(),oldvalue:prevVal,newvalue:m+","+(l?"1":"0"),property:j},false))}else{this.component.setNavigation("",false)}}this.dynamicModifiers.set(j,value)}}else{if(j=="caption"){value=p[n];if(value){var m,l=true;prevVal=this.component.caption.file+","+(this.component.enableCaptions?"1":"0");var o=value.split(",");if(o&&o.length>0){m=o[0];if(o.length>1){l=parseInt(o[1])!=0}if(m&&m.length>0){this.component.setCaption(m,l);this.dispatchEvent(new c.event.ControlComponentEvent(c.event.ControlComponentEvent.NOTF_CONTROLCOMPONENT_MODIFIERUPDATED,{id:this.component.getId(),oldvalue:prevVal,newvalue:m+","+(l?"1":"0"),property:j},false))}else{this.component.setCaptionEnabled(false)}}this.dynamicModifiers.set(j,value)}}else{if(j=="interactivedata"){value=p[n];if(value){var m,l=true;prevVal=this.component.interactiveData.file+","+(this.component.enableInteractiveData?"1":"0");var o=value.split(",");if(o&&o.length>0){m=o[0];if(o.length>1){l=parseInt(o[1])!=0}if(m&&m.length>0){this.component.setInteractiveData(m,l);this.dispatchEvent(new c.event.ControlComponentEvent(c.event.ControlComponentEvent.NOTF_CONTROLCOMPONENT_MODIFIERUPDATED,{id:this.component.getId(),oldvalue:prevVal,newvalue:m+","+(l?"1":"0"),property:j},false))}}this.dynamicModifiers.set(j,value)}}else{if(j=="mutevolume"){value=p[n];if(value){this.component.mute()}else{this.component.unmute()}}else{if(!h){h={}}h[n]=p[n]}}}}}if(h){this.superclass.prototype.setModifier.apply(this,[h])}};c.video.VideoPlayerControl.prototype.rebuild=function(y){if(this.component){var j=this.component.getVolume();var w=this.component.muted();var l=this.component.viewReadyEventSent;var s=this.component.metadataReadyEventSent;var u=this.component.assetSpecificPosterImage;var t=y.posterimage;y.posterimage=t?t:this.component.posterimage;var o=y.asset;var h=y.video;var q;var r=this.component.getCurrentAsset()?true:false;if(o){q=o;delete y.asset;l=false;s=false;r=true}else{if(h){q=h;delete y.video;l=false;s=false;r=false}else{if(r){q=this.component.getCurrentAsset()}else{q=this.component.getCurrentVideo()}}}var x,v,k;if((typeof this.component.getWidth=="function")&&(typeof this.component.getHeight=="function")){x=this.component.getWidth();v=this.component.getHeight()}var p,n;if(this.restrictedStylesValues[this.getCl()]){p=this.restrictedStylesValues[this.getCl()].width;n=this.restrictedStylesValues[this.getCl()].height}this.listenerProxy=c.Util.copyListeners(this.component);this.unload();this.component=new this.componentconstructor(this.parentId,y,this.compId,true);this.component.allowInitialUserEvent=false;this.restrictedStylesValues=this.readRestrictedStylesValues();var m=false;if(p&&n&&this.restrictedStylesValues[this.getCl()]){m=(p!=this.restrictedStylesValues[this.getCl()].width);m=m||(n!=this.restrictedStylesValues[this.getCl()].height)}if(!m&&(typeof this.component.resize=="function")){this.component.resize(x,v)}c.Util.assignListeners(this.listenerProxy,this.component);delete y.posterimage;if(this.component.assetSpecificPosterImage){u=this.component.assetSpecificPosterImage}else{if(t&&t.toLowerCase()=="none"){u=undefined}}if(r){this.component.setCurrentAsset(q,u)}else{this.component.setCurrentVideo(q,u)}this.component.setVolume(j);if(w){this.component.mute()}else{this.component.unmute()}this.component.viewReadyEventSent=l;this.component.metadataReadyEventSent=s}}}c.Class.inherits(c.video.VideoPlayerControl.NS,"s7sdk.ControlComponent");if(!c.video.VideoPlayer){c.video.VideoPlayer=function VideoPlayer(h,m,k){var n=!!arguments[3];arguments.callee.superclass.apply(this,[k,h,"div","s7videoplayer",m,!n]);this.createElement();this.container=this.getParent();this.videoServerUrl=c.Util.normalizeUrl(this.videoServerUrl);if(this.playback.type=="native"||this.playback.type=="flash"){this.playback.type="progressive"}if(this.video){this.playback.type=this.isHLSVideoUrl(this.video)}if(/(https?:\/\/[^\/]*)\b(\/DMGateway\/(private)\/)/.test(this.videoServerUrl)){this.videoServerUrl=this.videoServerUrl.replace(/(https?:\/\/[^\/]*)(\/[^\/]*)(\/private\/)/g,"$1$2/private-ssl/")}if(/(https?:\/\/[^\/]*)\b(\/DMGateway\/(public)\/)/.test(this.videoServerUrl)){this.videoServerUrl=this.videoServerUrl.replace(/(https?:)(\/\/[^\/]*)(\/[^\/]*)(\/public\/)/g,(((this.ssl=="on")||(c.browser.name=="ie"&&c.browser.version.minor==11&&(typeof(MediaSource)!="undefined")&&this.playback.type=="auto"))?"https:$2$3/public-ssl/":location.protocol+"$2$3$4"));this.videoServerUrl=this.videoServerUrl.replace(/(https:\/\/[^\/]*)(\/[^\/]*)(\/public\/)/g,"$1$2/public-ssl/")}this.compId=(c.Util.isNull(k)?"":k);this.videoItem=null;this.serverDuration=undefined;this.curMilestone=undefined;this.seekTime=undefined;this.methodCallQueue=[];this.setRequestLoaded=true;this.viewReadyEventSent=false;this.metadataReadyEventSent=false;this.allowInitialUserEvent=true;this.assetSpecificPosterImage=undefined;this.endNotificationSent=false;this.videoCapabilityState=new c.VideoCapabilityState();this.wid=this.size.width;this.hei=this.size.height;if(this.wid==0||this.hei==0){this.wid=parseInt(c.Util.css.getCss("s7videoplayer","width",this.compId,null,this.container));this.hei=parseInt(c.Util.css.getCss("s7videoplayer","height",this.compId,null,this.container));if(!c.Util.isNumber(this.wid)||!c.Util.isNumber(this.hei)||this.wid<=0||this.hei<=0){if("clientHeight" in this.container&&"clientWidth" in this.container){this.wid=this.container.clientWidth;this.hei=this.container.clientHeight}if(this.wid==0||this.hei==0){this.wid=400;this.hei=300}}}this.obj.style.width=this.wid+"px";this.obj.style.height=this.hei+"px";this.clickToPlay=0;if((/play/i).test(this.singleclick)){this.clickToPlay=1}this.serverUrl=c.Util.normalizeUrl(this.serverUrl);this.attachToContainer();var j=this;this.videoProxy=this.resolveVideoProxy();this.onTogglePauseHandler=function(o){if(window.MouseEvent&&o instanceof MouseEvent){j.togglePause()}};this.onClickHandler=function(o){c.Event.dispatch(j.obj,c.Event.CLICK,false)};this.onTouchEndHandler=function(o){if(window.TouchEvent&&o instanceof TouchEvent){j.ovlInTouch=true}};this.onTouchClickHandler=function(o){if(window.TouchEvent&&o instanceof TouchEvent){if(j.ovlInTouch){j.togglePause()}j.ovlInTouch=false}};if(!(this.playback.controls&&(this.playback.type=="progressive"||this.playback.type=="auto"))){this.divClickElement=document.createElement("div");this.obj.appendChild(this.divClickElement);this.divClickElement.style.width=this.wid+"px";this.divClickElement.style.height=this.hei+"px";this.divClickElement.style.position="absolute";this.divClickElement.style.top="0px";this.divClickElement.style.left="0px";if(c.browser.name=="ie"){this.divClickElement.style.opacity=0;if(c.browser.version.minor==9||c.browser.version.minor==10){this.divClickElement.style.backgroundColor="#000000"}}}if(this.clickToPlay&&!this.hasNativeControls()&&this.divClickElement){c.Event.addDOMListener(this.divClickElement,"touchend",j.onTouchEndHandler,false);c.Event.addDOMListener(this.obj,"click",j.onTouchClickHandler,false);c.Event.addDOMListener(this.obj,"click",j.onTogglePauseHandler,false)}if(!this.hasNativeControls()){c.Event.addDOMListener(this.obj,"click",j.onClickHandler,false)}this.createIconEffect();this.createWaitIcon();var l=unescape(this.asset);if(l!=""&&this.video==""){this.setAsset(l,this.posterimage)}if(this.video!=""){this.setVideo(this.video,this.posterimage)}if(this.posterimage&&this.posterimage!=""){if(this.posterimage.indexOf("?")!=0&&this.posterimage!="none"){this.assetSpecificPosterImage=this.posterimage;this.posterimage=""}else{this.assetSpecificPosterImage=undefined}}this.addEventListener(c.event.CapabilityStateEvent.NOTF_VIDEO_CAPABILITY_STATE,function(o){j.onCapabilityState(o)},false);this.setCaption(this.caption.file);this.setCaptionEnabled(this.caption.enabled);this.setNavigation(this.navigation.file,this.navigation.enabled);this.setInteractiveData(this.interactiveData.file);if(!n){return new c.video.VideoPlayerControl(this)}else{return this}};c.Class.inherits("s7sdk.video.VideoPlayer","s7sdk.UIComponent");c.video.VideoPlayer.prototype.symbols={ERROR:"Your Browser does not support HTML5 Video tag or the video cannot be played."};c.video.VideoPlayer.prototype.setModifier=function(h){throw new Error("Trying to use setModifier on the Core class (VideoPlayer) is unsupported! Please refer to SDK documentation on using setModifier.")};c.video.VideoPlayer.prototype.modifiers={serverUrl:{params:["isRootPath"],defaults:["/is/image/"]},videoServerUrl:{params:["value"],defaults:["/is/content/"]},contentUrl:{params:["value"],defaults:["/is/content/"]},size:{params:["width","height"],defaults:[0,0],ranges:["0:","0:"]},asset:{params:["value"],defaults:[""]},autoplay:{params:["enabled"],defaults:[true]},singleclick:{params:["singleclick"],defaults:["playPause"],ranges:[["none","playPause"]]},posterimage:{params:["posterimage"],defaults:[""]},iconEffect:{params:["enabled","count","fade","autoHide"],defaults:[true,1,0.3,3],ranges:[null,"-1:","0:","0:"]},playback:{params:["type","controls"],defaults:["auto",false],ranges:[["auto","native","progressive","flash"]]},progressivebitrate:{params:["value"],defaults:[700],ranges:["1:"]},caption:{params:["file","enabled"],defaults:["",false]},navigation:{params:["file","enabled"],defaults:["",true]},interactiveData:{params:["file","enabled"],defaults:["",true]},initialbitrate:{params:["value"],defaults:[0],ranges:["0:"]},aemmode:{params:["value"],defaults:[false],ranges:[[true,false]]},loop:{params:["enabled"],defaults:[false]},video:{params:["value"],defaults:[""],parseParams:false},ssl:{params:["value"],defaults:["auto"],ranges:[["auto","on"]],deprecated:true},waiticon:{params:["enabled"],defaults:[true]},preload:{params:["enabled"],defaults:[true]},mutevolume:{params:["enabled"],defaults:[false],ranges:[[true,false]]}};c.video.VideoPlayer.RESTRICTED_STYLES={s7videoplayer:["width","height"],"s7videoplayer s7iconeffect":["width","height"]};c.video.VideoPlayer.prototype.addEventListener=function(k,j,h){this.superproto.addEventListener.apply(this,[k,j,h])};c.video.VideoPlayer.prototype.getCurrentAsset=function(){return this.currentAsset};c.video.VideoPlayer.prototype.setCurrentAsset=function(j,h){this.assetSpecificPosterImage=h;if(typeof(j)=="string"){this.setAsset(j,h)}else{if(this.isReq_){this.isReq_.cancelHttpReq()}this.currentAsset=j;this.createViewer(j)}};c.video.VideoPlayer.prototype.getCurrentVideo=function(){return this.currentVideo};c.video.VideoPlayer.prototype.setCurrentVideo=function(j,h){this.assetSpecificPosterImage=h;if(typeof(j)=="string"){this.setVideo(j,h)}};c.video.VideoPlayer.prototype.onCapabilityState=function(h){var j=h.s7event.state;if(j.hasCapability(c.VideoCapabilityState.PAUSE)){if(this.iconEffectObj){this.iconEffectObj.hide()}this.showWaitIcon(this.videoProxy.isBuffering())}if(j.hasCapability(c.VideoCapabilityState.PLAY)){if(this.iconEffectObj){this.showWaitIcon(false);this.iconEffectObj.show(this.wid,this.hei);c.Util.css.setCSSAttributeSelector(this.iconEffectObj.obj,"state","play")}}if(j.hasCapability(c.VideoCapabilityState.REPLAY)){if(this.iconEffectObj){this.showWaitIcon(false);this.iconEffectObj.show(this.wid,this.hei);c.Util.css.setCSSAttributeSelector(this.iconEffectObj.obj,"state","replay")}}};c.video.VideoPlayer.prototype.isHLSVideoUrl=function(h){return(/.m3u8(?=\?|$)/i).test(h)?"auto":"progressive"};c.video.VideoPlayer.prototype.getWidth=function(){return this.wid};c.video.VideoPlayer.prototype.getHeight=function(){return this.hei};c.video.VideoPlayer.prototype.resize=function(j,k){if(j==this.wid&&k==this.hei){return}this.wid=j>0?j:1;this.hei=k>0?k:1;this.videoProxy.resize(this.wid,this.hei);this.obj.style.width=this.wid+"px";this.obj.style.height=this.hei+"px";if(this.divClickElement){this.divClickElement.style.width=this.wid+"px";this.divClickElement.style.height=this.hei+"px"}if(this.iconEffectObj&&this.iconEffectObj.enabled){this.iconEffectObj.centerOverlay(j,k)}if(this.captionContainerDiv){this.obj.removeChild(this.captionContainerDiv);this.captionContainerDiv=undefined}c.UIComponent.prototype.resize.apply(this,[j,k]);c.Logger.log(c.Logger.INFO,"VideoPlayer.resize( %0 %1 )",j,k)};c.video.VideoPlayer.prototype.supportsInline=function(){c.Logger.log(c.Logger.INFO,"VideoPlayer.supportsInline() = %0",!((c.browser.device.name=="android"&&c.browser.device.version<4)||c.browser.device.name=="iphone"));return !((c.browser.device.name=="android"&&c.browser.device.version<4)||(c.browser.device.name=="iphone"&&c.browser.device.version<10))};c.video.VideoPlayer.prototype.getAsset=function(){var h=(this.videoItem==null?null:this.videoItem.name);c.Logger.log(c.Logger.INFO,"VideoPlayer.getAsset() = %0",h);return h};c.video.VideoPlayer.prototype.invalidateWebVttData=function(){this.captionCues=[];this.invalidateNavigation();this.invalidateInteractiveData()};c.video.VideoPlayer.prototype.setAsset=function(k,h){this.metadataReadyEventSent=false;this.viewReadyEventSent=false;this.setRequestLoaded=false;this.methodCallQueue.splice(0,this.methodCallQueue.length);var j=new c.event.VideoEvent(c.event.VideoEvent.NOTF_CURRENT_TIME,0,true);this.dispatchEvent(j,false);this.invalidateWebVttData();this.assetSpecificPosterImage=h;this.currentAsset=k;this.loadAsset(k);c.Logger.log(c.Logger.INFO,"VideoPlayer.setAsset( %0 )",k+(h?", "+h:""))};c.video.VideoPlayer.prototype.setVideo=function(k,h){this.metadataReadyEventSent=false;this.viewReadyEventSent=false;this.setRequestLoaded=true;this.methodCallQueue.splice(0,this.methodCallQueue.length);var j=new c.event.VideoEvent(c.event.VideoEvent.NOTF_CURRENT_TIME,0,true);this.dispatchEvent(j,false);this.invalidateWebVttData();this.assetSpecificPosterImage=h;var l=this.isHLSVideoUrl(k);if(this.playback.type!=l){this.playback.type=l;this.videoProxy.dispose();this.videoProxy=this.resolveVideoProxy()}this.currentVideo=k;this.videoProxy.setVideo(k,h);c.Logger.log(c.Logger.INFO,"VideoPlayer.videoName( %0 )",k+(h?", "+h:""))};c.video.VideoPlayer.prototype.setCaption=function(h){this.caption.file=h;this.captionCues=[];if(c.Util.isNonEmptyString(this.caption.file)){this.loadWebVTT()}};c.video.VideoPlayer.prototype.setNavigation=function(h){var j=true;if(arguments.length>1){j=arguments[1]}this.navigation.file=h;this.enableNavigation=j;this.navigationCues=null;if(c.Util.isNonEmptyString(this.navigation.file)){this.loadNavigationWebVTT()}};c.video.VideoPlayer.prototype.setInteractiveData=function(h){var j=true;if(arguments.length>1){j=arguments[1]}this.interactiveData.file=h;this.enableInteractiveData=j;this.interactiveCues=null;this.currentInteractiveDataIndex=-1;this.currentInteractiveDataCueIndex=-1;if(c.Util.isNonEmptyString(this.interactiveData.file)){this.loadInteractiveDataWebVTT()}};c.video.VideoPlayer.prototype.loadAsset=function(h){c.Logger.log(c.Logger.INFO,"VideoPlayer.loadAsset");var j=c.Util.resolveURL(this.serverUrl,c.MediaSetParser.parseAssetForSetReq(h).req);if(c.Util.isNonEmptyString(this.locale)){j+="&locale="+this.locale}if(this.isReq_){this.isReq_.cancelHttpReq()}this.isReq_=new c.IS();this.isReq_.getHttpReq(j,function(l,k){c.video.VideoPlayer.prototype.setRequestComplete.apply(k,[l])},function(l,k){c.video.VideoPlayer.prototype.setRequestError.apply(k,[l,h])},this)};c.video.VideoPlayer.prototype.invalidateNavigation=function(){if(this.videoItem){c.Logger.log(c.Logger.INFO,"Invalidate navigation content");var h=new c.event.VideoEvent(c.event.VideoEvent.NOTF_NAVIGATION,null,true);this.dispatchEvent(h,false)}this.navigationCues=null};c.video.VideoPlayer.prototype.loadNavigationWebVTT=function(){var h;if(/^\s*http[s]?:\/\//.test(this.navigation.file)){h=this.navigation.file}else{h=c.Util.resolveURL(this.contentUrl,this.navigation.file)}h+="?req=CONTENT,json,utf-8";if(this.navigationReq){this.navigationReq.cancelHttpReq()}var j=this;this.navigationReq=new c.IS();this.navigationReq.getHttpReq(h,function(m,k){j.navigationCues=c.common.WebVtt.parse(m,c.common.WebVtt.TYPE_NAVIGATION);var n=(j.enableNavigation)?j.navigationCues:null;var l=new c.event.VideoEvent(c.event.VideoEvent.NOTF_NAVIGATION,n,true);j.dispatchEvent(l,false)},function(k){c.Logger.log(c.Logger.WARNING,"Error loading navigation file: %0",j.navigation.file)},this)};c.video.VideoPlayer.prototype.loadWebVTT=function(){var h;if(/^\s*http[s]?:\/\//.test(this.caption.file)){h=this.caption.file}else{h=c.Util.resolveURL(this.contentUrl,this.caption.file)}h+="?req=CONTENT,json,utf-8";if(this.captionReq){this.captionReq.cancelHttpReq()}var j=this;this.captionReq=new c.IS();this.captionReq.getHttpReq(h,function(m,k){var l=c.common.WebVtt.parse(m,c.common.WebVtt.TYPE_CAPTION).getItems();for(i in l){var n=l[i];k.captionCues.push({start:n.start,end:n.end,caption:n.data,settings:n.settings})}k.checkCaptions(k.getCurrentTime())},function(k){c.Logger.log(c.Logger.ERROR,"Error loading caption file: %0",j.caption.file)},this)};c.video.VideoPlayer.prototype.invalidateInteractiveData=function(){if(this.videoItem){c.Logger.log(c.Logger.INFO,"Invalidate interactive data content");var h=new c.event.VideoEvent(c.event.InteractiveDataEvent.NOTF_INTERACTIVE_DATA,null,true);this.dispatchEvent(h,false);this.interactiveDataCues=null;this.interactiveData_=null;this.globalInteractiveDataSegment=null;this.interactiveDataSegments=null}};c.video.VideoPlayer.prototype.loadInteractiveDataWebVTT=function(){var h;if(/^\s*http[s]?:\/\//.test(this.interactiveData.file)){h=this.interactiveData.file}else{h=c.Util.resolveURL(this.contentUrl,this.interactiveData.file)}h.indexOf("?")==-1?h+="?":h+="&";h+="req=CONTENT,json,utf-8";if(this.interactiveDataReq){this.interactiveDataReq.cancelHttpReq()}var j=this;this.interactiveDataReq=new c.IS();this.interactiveDataReq.getHttpReq(h,function(l,k){j.setInteractiveDataCues(c.common.WebVtt.parse(l,c.common.WebVtt.TYPE_METADATA))},function(k){c.Logger.log(c.Logger.WARNING,"Error loading interactive data file: %0",j.interactiveData.file)},this)};c.video.VideoPlayer.prototype.setInteractiveDataCues=function(q){var p=this;p.interactiveDataCues=q;p.interactiveData_=null;var o=(p.enableInteractiveData)?p.interactiveDataCues:null;if(o&&o.items){p.interactiveData_=[];p.globalInteractiveDataSegment=null;var h=-1;var j=-1;var r=-1;for(var n=0;n<o.items.length;n++){var k=Number(o.items[n].start),m=Number(o.items[n].end);if(h==-1){h=k;j=m;if(o.items[n].data.hasOwnProperty("properties")){c.Logger.log(c.Logger.FINE,"global segment: %0 --> %1",k,m);r=p.interactiveData_.length;p.globalInteractiveDataSegment=o.items[n]}}else{if(k<h){h=k}if(m>=j){j=m;if(k==h&&o.items[n].data.hasOwnProperty("properties")){c.Logger.log(c.Logger.FINE,"global segment: %0 --> %1",k,m);p.globalInteractiveDataSegment=o.items[n];r=p.interactiveData_.length}}if(p.globalInteractiveDataSegment&&(Number(p.globalInteractiveDataSegment.start)!=h||Number(p.globalInteractiveDataSegment.end)!=j)){r=-1;p.globalInteractiveDataSegment=null}}c.Logger.log(c.Logger.FINE,"Cue["+n+"]: "+o.items[n]);p.interactiveData_.push(o.items[n].data)}function s(t){o.items.splice(t,1);p.interactiveData_.splice(t,1)}if(r!=-1){c.Logger.log(c.Logger.FINE,"Remove global InteractiveData WebVTT segment[%0]",r);s(r)}for(var n=p.interactiveData_.length-1;n>=0;n--){if(!p.interactiveData_[n].swatches&&!p.interactiveData_[n].imagemap){c.Logger.log(c.Logger.FINE,"Remove InteractiveData WebVTT segment[%0] that does not have swatches",n);s(n)}}}p.processInteractiveData(-1);var l=new c.event.InteractiveDataEvent(c.event.InteractiveDataEvent.NOTF_INTERACTIVE_DATA,{properties:p.getInteractiveDataProperties(),interactiveData:p.getInteractiveData()},true);p.dispatchEvent(l,false)};c.video.VideoPlayer.prototype.processInteractiveData=function(l){if(l!=-1&&!l){c.Logger.log(c.Logger.SEVERE,"Invalid number of visible interactive data elements: %0",count);return}this.interactiveDataVisible=l;if(!this.interactiveDataCues){c.Logger.log(c.Logger.WARNING,"Interactive data uninitialized");return}function t(B,A){if(B&&B instanceof Object){return B[A]}return null}var q=this.interactiveDataCues;this.interactiveDataSegments=[];var n=0;var o;for(var w=0;w<q.items.length;w++){var z=q.items[w];c.Logger.log(c.Logger.INFO,"Cue["+w+"]: "+z);var r=t(t(t(z,"data"),"swatches"),"item");if(!r){c.Logger.log(c.Logger.WARNING,"Ignore InteractiveData WebVTT segment[%0] that does not have swatches",w);continue}if(l==-1||r.length<l){this.interactiveDataSegments.push({start:z.start,end:z.end,index:n})}else{var v=Math.ceil(r.length/l);var h=Number(z.end)-Number(z.start);var s=Math.ceil(h/v),k=h,j=Math.ceil(r.length/v);var y=r.length;var p=Number(z.start),m;var o=n;var x=n+r.length-l;for(var u=0;u<v;u++){if(y<=l){m=Number(z.end)}else{m=p+s}this.interactiveDataSegments.push({start:p,end:m,index:Math.min(o,x)});p=m;o+=j;k-=s;y-=j}}n+=r.length}for(var w=0;w<this.interactiveDataSegments.length;w++){c.Logger.log(c.Logger.FINE,"Interactive data segments[%0]: %1 - %2, %3",w,this.interactiveDataSegments[w].start,this.interactiveDataSegments[w].end,this.interactiveDataSegments[w].index)}};c.video.VideoPlayer.prototype.updateVisibleInterativeData=function(h){if(!h){c.Logger.log(c.Logger.SEVERE,"Invalid number of visible interactive data elements: %0",h);return}this.processInteractiveData(h)};c.video.VideoPlayer.prototype.setRequestComplete=function(j){var o=this.videoItem;var h=j.set;if(h==null){return}var m=c.MediaSetParser.parse(h,"");switch(m.type){case c.ItemDescType.VIDEO_SET:this.createViewer(m);break;case c.ItemDescType.VIDEO:this.createViewer(m.items[0]);break;case c.ItemDescType.VIDEO_GROUP:this.createViewer(m);break;default:throw new Error("parsed media set is of wrong type: "+m.type)}this.setRequestLoaded=true;while(this.methodCallQueue.length>0){var l=this.methodCallQueue[0];this.methodCallQueue.splice(0,1);this[l.func].apply(this,l.args)}if(!this.metadataReadyEventSent){var k=new c.event.StatusEvent(c.event.StatusEvent.NOTF_ASSET_METADATA_READY,true);c.Event.dispatch(this.obj,k,false);this.metadataReadyEventSent=true}if(o!=null){var n=new c.UserEvent(c.UserEvent.SWAP,[0,this.videoItem],true);this.dispatchEvent(n,false)}};c.video.VideoPlayer.prototype.createViewer=function(h){this.videoCapabilityState=new c.VideoCapabilityState();this.endNotificationSent=false;this.setAssetInternal(h);this.settings.trackLoad(this);this.checkCaptions(this.getCurrentTime());if(this.allowInitialUserEvent){var k=new c.UserEvent(this.autoplay?c.UserEvent.PLAY:c.UserEvent.PAUSE,this.videoProxy.getCurrentTime(),true);this.dispatchEvent(k,false);this.allowInitialUserEvent=false}var j=new c.event.AssetEvent(c.event.AssetEvent.ASSET_CHANGED,h,this.getIndexFromItem(h),true);this.dispatchEvent(j)};c.video.VideoPlayer.prototype.getIndexFromItem=function(l){if(l.parent!=null){var k=-1;var j=l.parent.items;for(var h=0;h<j.length;h++){if(j[h].name==l.name){k=h;break}}return k}else{return 0}};c.video.VideoPlayer.prototype.createIconEffect=function(){if(this.clickToPlay&&!this.hasNativeControls()){this.iconEffectObj=new c.IconEffect(this,this.iconEffect.enabled,this.iconEffect.count,this.iconEffect.fade,this.iconEffect.autoHide);if(this.autoplay){this.iconEffectObj.hide();this.showWaitIcon(this.videoProxy.isBuffering())}}};c.video.VideoPlayer.prototype.createWaitIcon=function(){if(this.waiticon){this.waitIconObj=document.createElement("div");this.waitIconObj.className="s7waiticon";this.waitIconObj.style.visibility="hidden";if(this.obj){this.obj.appendChild(this.waitIconObj)}}};c.video.VideoPlayer.prototype.hasNativeControls=function(){if((c.browser.device.name=="android"&&c.browser.device.version<4)||this.playback.controls){return true}else{return false}};c.video.VideoPlayer.prototype.setCaptionEnabled=function(h){var j=!this.enableCaptions&&h&&this.videoProxy.paused();this.enableCaptions=h;if(!this.enableCaptions){if(this.currentCaption){this.hideCaption();this.currentCaption=null}}else{if(j&&this.videoProxy){this.checkCaptions(this.videoProxy.getCurrentTime())}}};c.video.VideoPlayer.prototype.getCaptionEnabled=function(){return this.enableCaptions};c.video.VideoPlayer.prototype.checkCaptions=function(j){if(this.captionCues.length==0){return}if(!this.enableCaptions){return}var h=this.findCaption(j);if(this.currentCaption&&h&&this.currentCaption.start==h.start){return}this.currentCaption=h;if(h){this.showCaption(h.caption,h.settings)}else{this.hideCaption()}};c.video.VideoPlayer.prototype.showCaption=function(q,k){if(!this.captionContainerDiv){this.captionContainerDiv=document.createElement("div");this.captionContainerDiv.style.position="absolute";this.captionContainerDiv.style.visibility="hidden";this.captionContainerDiv.style.overflow="hidden";if(this.iconEffectObj.hiddenState_){this.obj.appendChild(this.captionContainerDiv)}else{this.obj.insertBefore(this.captionContainerDiv,this.iconEffectObj.iconEffectDiv_)}this.captionDiv=document.createElement("div");this.captionDiv.className="s7caption";this.captionDiv.style.visibility="hidden";this.captionContainerDiv.appendChild(this.captionDiv);this.captionDiv.style.position="relative";this.captionDiv.style.display="table"}else{this.captionDiv.style.visibility="hidden"}this.captionContainerDiv.style.width=this.wid+"px";this.captionDiv.innerText=q;this.captionDiv.textContent=q;var o=this.captionDiv.offsetHeight;var m=this.captionDiv.offsetWidth;var p,j,h;if(k.vertical=="rl"){p=Math.round((100-parseInt(k.lineSize))/2);this.captionContainerDiv.style.top=p+"%";this.captionContainerDiv.style.height=k.lineSize;this.captionContainerDiv.style.left=k.linePosition}else{if(k.vertical=="lr"){p=Math.round((100-parseInt(k.lineSize))/2);this.captionContainerDiv.style.top=p+"%";this.captionContainerDiv.style.height=k.lineSize;j=(100-parseInt(k.linePosition));this.captionContainerDiv.style.left=j+"%"}else{m=Math.min(Math.round(parseInt(k.lineSize)*this.wid/100),m);this.captionContainerDiv.style.width=m+"px";m=this.captionDiv.offsetWidth;j=Math.round(((parseInt(k.textPosition)/100)*this.wid)-m/2);j=j<0?0:j;if((j+m)>this.wid){j=this.wid-m}this.captionContainerDiv.style.left=j+"px";o=this.captionDiv.offsetHeight;var n=(o/this.hei)*100;if(k.linePosition){if(k.linePosition.indexOf("%")>0){var l=parseInt(k.linePosition);p=l-(n)/2;h=l+n;if(n>100){p=0}else{if(p<0){p=0}else{if(h>100){if(n>100){p=0}else{p=100-n}}}}if((n+p)>100){n=100-p}this.captionContainerDiv.style.top=p+"%"}else{this.captionContainerDiv.style.bottom=(o*(k.linePosition-1))+"px"}this.captionContainerDiv.style.height=n+"%"}else{if(n>85){this.captionContainerDiv.style.top="0"}else{this.captionContainerDiv.style.top=(85-n)+"%"}this.captionContainerDiv.style.bottom="15%"}}}if(k.vertical=="rl"){this.captionDiv.style.writingMode="tb-rl"}else{if(k.vertical=="lr"){this.captionDiv.style.writingMode="tb-rl"}}if(k.textAlign=="left"){this.captionDiv.style.textAlign="left"}else{if(k.textAlign=="right"){this.captionDiv.style.textAlign="right"}else{if(k.textAlign=="middle"){this.captionDiv.style.textAlign="center"}}}this.captionDiv.style.visibility="inherit";this.captionContainerDiv.style.visibility="inherit"};c.video.VideoPlayer.prototype.hideCaption=function(){if(this.captionContainerDiv){this.captionDiv.style.visibility="hidden";this.captionContainerDiv.visibility="hidden";this.captionDiv.innerText="";this.captionDiv.textContent=""}};c.video.VideoPlayer.prototype.findCaption=function(j){var h=c.video.VideoPlayer.findWebVttIndex(this.captionCues,j);if(h!=-1){return this.captionCues[h]}return null};c.video.VideoPlayer.findWebVttIndex=function(m,o,n){if(m){var k=0;var l=-1;for(var j=0;j<m.length;j++){var h=m[j];if(!h){continue}var p=Number(h.start);if(p<=o){if(o<=Number(h.end)){return j}if(p>k){k=p;l=j}}}if(n){return l}}return -1};c.video.VideoPlayer.prototype.getNavigation=function(){return this.navigationCues};c.video.VideoPlayer.prototype.getNavigationEnabled=function(){return this.enableNavigation};c.video.VideoPlayer.prototype.getInteractiveData=function(){return this.interactiveData_};c.video.VideoPlayer.prototype.getInteractiveDataProperties=function(){return(this.globalInteractiveDataSegment&&this.globalInteractiveDataSegment.data)?this.globalInteractiveDataSegment.data.properties:null};c.video.VideoPlayer.prototype.checkInteractiveData=function(m,r){if(!this.enableInteractiveData){return}var s=this;if(!this.interactiveDataCues||!this.interactiveDataCues.items){return}var p=c.video.VideoPlayer.findWebVttIndex(this.interactiveDataCues.items,m,false);if(this.currentInteractiveDataCueIndex!=p){var h=null;if(p!=-1){var k=this.interactiveDataCues.items;if(k&&k[p]){var n=k[p].data;if(n&&n.imagemap){h=n.imagemap}}}l(h);this.currentInteractiveDataCueIndex=p}if(!this.interactiveDataSegments||this.interactiveDataSegments.length==0){return}var q=c.video.VideoPlayer.findWebVttIndex(this.interactiveDataSegments,m);if(q==-1&&r){var o=c.video.VideoPlayer.findWebVttIndex(this.interactiveDataSegments,m,r);if(this.currentInteractiveDataIndex!=o){this.currentInteractiveDataIndex=o;j(o)}}if(this.currentInteractiveDataIndex==q){return}this.currentInteractiveDataIndex=q;j(q);function j(t){var v=t==-1?-1:s.interactiveDataSegments[t].index;c.Logger.log(c.Logger.INFO,"Interactive segment %0, swatch %1",t,v);var u=new c.event.InteractiveDataEvent(c.event.InteractiveDataEvent.NOTF_ACTIVE_INTERACTIVE_DATA_UPDATED,v,true);s.dispatchEvent(u,false)}function l(u){c.Logger.log(c.Logger.INFO,"Interactive map %0",u);var t=new c.event.InteractiveDataEvent(c.event.InteractiveDataEvent.NOTF_ACTIVE_INTERACTIVE_MAP_DATA_UPDATED,u,true);s.dispatchEvent(t,false)}};c.video.VideoPlayer.prototype.getInteractiveDataEnabled=function(){return this.enableInteractiveData};c.video.VideoPlayer.prototype.imagePixelsToViewPoint=function(j){if(this==null){return new c.Point2D(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY)}var h=new c.Point2D(j.x,j.y);var l=new c.Point2D(0,0);h.x=h.x+l.x;h.y=h.y+l.y;var k=new c.Point2D(j.x-l.x,j.y-l.y);return h};c.video.VideoPlayer.prototype.viewPointToImagePixels=function(h){return h};c.video.VideoPlayer.prototype.resolveVideoProxy=function(){var j;if(c.browser.device.name=="iphone"){j=this.buildIphoneVideoProxy()}else{if(this.playback.type=="auto"&&((c.browser.name=="firefox"&&c.browser.version.minor>=45)||(c.browser.name=="ie"&&c.browser.version.minor==11&&(typeof(MediaSource)!="undefined"))||(c.browser.device.name=="desktop"&&c.browser.name=="chrome"))&&!(/^((http|https):\/\/[^\/]*)\b(\/DMGateway\/(private-ssl|private)\/)/.test(this.videoServerUrl))){j=this.buildHLSVideoProxy()}else{j=this.buildHTML5VideoProxy()}}var h=this;j.onCurrentTime=function(){var m=h.videoProxy.getCurrentTime();h.checkCaptions(m);h.checkInteractiveData(m);if(!h.endNotificationSent){h.checkTimingEvents()}h.checkState();if(!h.endNotificationSent){var k=new c.event.VideoEvent(c.event.VideoEvent.NOTF_CURRENT_TIME,h.videoProxy.getCurrentTime(),true);h.dispatchEvent(k,false);if(h.pendingStopNotification||h.videoProxy.ended()){h.pendingStopNotification=false;var n=new c.UserEvent(c.UserEvent.STOP,h.videoProxy.getCurrentTime(),true);h.dispatchEvent(n,false)}if(h.videoProxy.ended()){h.endNotificationSent=true;var l=new c.event.VideoEvent(c.event.VideoEvent.NOTF_VIDEO_END,h.videoProxy.getCurrentTime(),true);h.dispatchEvent(l,false)}}};j.onDuration=function(){h.checkState();var l=new c.event.UserEvent(c.UserEvent.METADATA,["DURATION",h.videoProxy.getDuration()],true);h.dispatchEvent(l,false);var k=new c.event.VideoEvent(c.event.VideoEvent.NOTF_DURATION,h.videoProxy.getDuration(),true);h.dispatchEvent(k,false)};j.onLoadProgress=function(){h.checkState();var k=new c.event.VideoEvent(c.event.VideoEvent.NOTF_LOAD_PROGRESS,h.videoProxy.getLoadedPosition(),true);h.dispatchEvent(k,false)};j.onVolume=function(){h.checkState();var k=new c.event.VideoEvent(c.event.VideoEvent.NOTF_VOLUME,h.videoProxy.getVolume(),true);h.dispatchEvent(k,false)};j.onSeeked=function(){var m=h.videoProxy.getCurrentTime();if(m!=h.videoProxy.getDuration()){if(h.videoProxy.paused()&&h.iconEffectObj){if(h.waitIconObj){h.showWaitIcon(false)}h.iconEffectObj.show(this.wid,this.hei)}}if(m!=this.seekTime){var n=new c.event.VideoEvent(c.event.VideoEvent.NOTF_SEEK,h.videoProxy.getCurrentTime(),true);h.dispatchEvent(n,false);var l=new c.event.UserEvent(c.UserEvent.METADATA,["SEEK",h.videoProxy.getCurrentTime()],true);h.dispatchEvent(l,false)}this.seekTime=h.videoProxy.getCurrentTime();var k=new c.event.VideoEvent(c.event.VideoEvent.NOTF_CURRENT_TIME,this.seekTime,true);h.dispatchEvent(k,false)};j.onStateChange=function(){h.checkState()};j.onViewReady=function(){if(!h.viewReadyEventSent){var k=new c.event.StatusEvent(c.event.StatusEvent.NOTF_VIEW_READY,true);c.Event.dispatch(h.obj,k,false)}h.viewReadyEventSent=true};j.onBuffering=function(k){h.showWaitIcon(k)};j.isBuffering=function(){return h.isbuffering};return j};c.video.VideoPlayer.prototype.resolvePosterUrl=function(j){var k=(this.assetSpecificPosterImage!=undefined)?this.assetSpecificPosterImage:this.posterimage;var l="";if(k==""||k.indexOf("?")==0){l=k;if(this.aemmode){k=j.name}else{if(j.hasOwnProperty("image")&&j.image){k=c.video.VideoPlayer.parseMovieUrl(j.image.name)}else{k=c.video.VideoPlayer.parseMovieUrl(j.name)}}}var h=null;if(k!=null&&k!=""&&k!="none"){var m=(k.indexOf("?")>=0)?"&":"?";if(l!=""){if(l.indexOf("?")==0){m=l}else{m+=l}m+="&"}m+="fit=constrain,1&wid="+this.wid+"&hei="+this.hei;h=k+m}return h};c.video.VideoPlayer.prototype.buildHTML5VideoProxy=function(){return new c.video.HTML5VideoProxy(this.obj,this.wid,this.hei,this.serverUrl,this.videoServerUrl,this.autoplay,this.playback,this.progressivebitrate,this.loop,this.preload,this.mutevolume,this.getLocalizedText("ERROR"),this.aemmode)};c.video.VideoPlayer.prototype.buildIphoneVideoProxy=function(){return new c.video.IPhoneProxy(this.obj,this.wid,this.hei,this.serverUrl,this.videoServerUrl,this.autoplay,this.playback,this.progressivebitrate,this.loop,this.preload,this.mutevolume,this.getLocalizedText("ERROR"),this.aemmode)};c.video.VideoPlayer.prototype.buildHLSVideoProxy=function(){return new c.video.HLSVideoProxy(this.obj,this.wid,this.hei,this.serverUrl,this.videoServerUrl,this.autoplay,this.playback,this.progressivebitrate,this.initialbitrate,this.loop,this.preload,this.mutevolume,this.getLocalizedText("ERROR"),this.aemmode)};c.video.VideoPlayer.prototype.setRequestError=function(h){c.Logger.log(c.Logger.ERROR,"setRequestError %0",h)};c.video.VideoPlayer.prototype.setAssetInternal=function(h){this.videoItem=h;this.serverDuration=c.video.VideoPlayer.getDurationFromItem(h);this.videoProxy.serverDuration=this.serverDuration;if(!c.Util.isNull(this.serverDuration)){var j=new c.event.VideoEvent(c.event.VideoEvent.NOTF_DURATION,this.serverDuration,true);this.dispatchEvent(j,false)}this.videoProxy.setAsset(h,this.resolvePosterUrl(h))};c.video.VideoPlayer.prototype.setItem=function(j){c.Logger.log(c.Logger.INFO,"VideoPlayer.setItem( %0 )",j);if(this.isReq_){this.isReq_.cancelHttpReq()}if(!((j instanceof c.VideoDesc&&j.type==c.ItemDescType.VIDEO)||(j instanceof c.MediaSetDesc&&(j.type==c.ItemDescType.VIDEO_SET)||j.type==c.ItemDescType.VIDEO_GROUP))){throw new Error("Item must be a video!")}this.allowInitialUserEvent=true;this.currentAsset=j;if(this.asset!=""){this.assetSpecificPosterImage=undefined}var h=new c.event.VideoEvent(c.event.VideoEvent.NOTF_CURRENT_TIME,0,true);this.dispatchEvent(h,false);this.invalidateWebVttData();this.createViewer(j);this.asset="";if(!this.metadataReadyEventSent){var k=new c.event.StatusEvent(c.event.StatusEvent.NOTF_ASSET_METADATA_READY,true);c.Event.dispatch(this.obj,k,false);this.metadataReadyEventSent=true}};c.video.VideoPlayer.prototype.getVolume=function(){if(this.supportsVolumeControl()){return this.videoProxy.getVolume()}else{return 1}};c.video.VideoPlayer.prototype.setVolume=function(h){if(this.supportsVolumeControl()){this.videoProxy.setVolume(h);this.checkState()}};c.video.VideoPlayer.prototype.getCurrentTime=function(){return this.videoProxy.getCurrentTime()};c.video.VideoPlayer.prototype.getLoadedPosition=function(){return this.videoProxy.getLoadedPosition()};c.video.VideoPlayer.prototype.getDuration=function(){if(!c.Util.isNull(this.videoProxy.getDuration())){return this.videoProxy.getDuration()}else{if(!c.Util.isNull(this.serverDuration)){return this.serverDuration}else{return undefined}}};c.video.VideoPlayer.prototype.getCapabilityState=function(){c.Logger.log(c.Logger.INFO,"VideoPlayer.getCapabilityState() = %0 ",this.videoCapabilityState);return this.videoCapabilityState};c.video.VideoPlayer.prototype.checkState=function(){var h=this.videoCapabilityState;this.videoCapabilityState=new c.VideoCapabilityState();if(this.videoProxy.paused()&&!this.videoProxy.ended()){this.videoCapabilityState.setCapability(c.VideoCapabilityState.PLAY);if(this.videoProxy.getCurrentTime()>0){this.videoCapabilityState.setCapability(c.VideoCapabilityState.STOP)}}if(!this.videoProxy.paused()&&!this.videoProxy.ended()){if(((c.browser.name=="chrome")||((c.browser.name=="safari")&&(c.browser.version.minor==6)))&&(c.browser.device.name=="desktop")&&this.divClickElement){this.divClickElement.style.opacity=0;this.divClickElement.style.opacity=1}this.videoCapabilityState.setCapability(c.VideoCapabilityState.PAUSE);this.videoCapabilityState.setCapability(c.VideoCapabilityState.STOP)}this.videoProxy.muted()?this.videoCapabilityState.setCapability(c.VideoCapabilityState.UNMUTE):this.videoCapabilityState.setCapability(c.VideoCapabilityState.MUTE);if(this.videoProxy.ended()){this.videoCapabilityState.setCapability(c.VideoCapabilityState.REPLAY)}if((h==null)||(h.state!=this.videoCapabilityState.state)){this.dispatchEvent(new c.event.CapabilityStateEvent(c.event.CapabilityStateEvent.NOTF_VIDEO_CAPABILITY_STATE,this.videoCapabilityState))}};c.video.VideoPlayer.prototype.ended=function(){return this.videoProxy.ended()};c.video.VideoPlayer.prototype.play=function(){if(!this.setRequestLoaded){this.fillMethodQueue("play");return}if(!this.videoProxy.ended()){this.videoProxy.play();this.currentInteractiveDataIndex=-1;this.currentInteractiveDataCueIndex=-1;var h=this.videoProxy.getCurrentTime();this.checkInteractiveData(h,true);var j=new c.UserEvent(c.UserEvent.PLAY,h,true);this.dispatchEvent(j,false);this.endNotificationSent=false}};c.video.VideoPlayer.prototype.pause=function(){if(!this.setRequestLoaded){this.fillMethodQueue("pause");return}this.videoProxy.pause();var h=new c.UserEvent(c.UserEvent.PAUSE,this.videoProxy.getCurrentTime(),true);this.dispatchEvent(h,false)};c.video.VideoPlayer.prototype.stop=function(){if(!this.setRequestLoaded){this.fillMethodQueue("stop");return}this.videoProxy.pause();this.videoProxy.seek(0);this.pendingStopNotification=true};c.video.VideoPlayer.prototype.togglePause=function(){if(this.videoCapabilityState!=null){if(this.videoCapabilityState.hasCapability(c.VideoCapabilityState.PLAY)||this.videoCapabilityState.hasCapability(c.VideoCapabilityState.REPLAY)){var h=this.getDuration()-this.getCurrentTime();if(h<=1){this.seek(0)}this.play()}else{if(this.videoCapabilityState.hasCapability(c.VideoCapabilityState.PAUSE)){this.pause()}}}};c.video.VideoPlayer.prototype.seek=function(j){if(!this.setRequestLoaded){this.fillMethodQueue("seek",[j]);return}this.videoProxy.seek(j);var h=this.getCurrentTime();if(!c.Util.isNumber(h)){h=j}this.checkInteractiveData(h,true);this.endNotificationSent=false};c.video.VideoPlayer.prototype.muted=function(){if(this.supportsVolumeControl()){return this.videoProxy.muted()}else{return false}};c.video.VideoPlayer.prototype.mute=function(){if(this.supportsVolumeControl()){this.videoProxy.mute(true);this.checkState()}};c.video.VideoPlayer.prototype.unmute=function(){if(this.supportsVolumeControl()){this.videoProxy.mute(false);this.checkState()}};c.video.VideoPlayer.prototype.checkTimingEvents=function(){var h=this.videoProxy.getDuration();if(c.Util.isNull(h)||h==0){return}var k=c.Util.isNull(this.videoProxy.getCurrentTime())?0:this.videoProxy.getCurrentTime();k=25*Math.floor((k*4)/h);if(k!=this.curMilestone){this.curMilestone=k;var j=new c.UserEvent(c.UserEvent.MILESTONE,this.curMilestone,true);this.dispatchEvent(j,false)}};c.video.VideoPlayer.prototype.fillMethodQueue=function(j,h){this.methodCallQueue.push({func:j,args:h})};c.video.VideoPlayer.parseMovieUrl=function(j){var h=null;if(j){h=j.replace(/[\\]/g,"/");ar=h.split(/\.(mp4|f4v|flv|webm)/i);if(ar.length>1){h=ar[0]}ar=h.split(":");if(ar.length>1){h=ar[1]}ar=h.split("/");h=ar.length>1?ar[0]+"/"+ar[ar.length-1]:h}return h};c.video.VideoPlayer.prototype.supportsVolumeControl=function(){var h=true;if(("ipad"==c.browser.device.name)||("iphone"==c.browser.device.name)||("android"==c.browser.device.name)){h=false}return h};c.video.VideoPlayer.prototype.setCSS=function(k,j,h){if(this.isRestrictedCSSProperty(c.video.VideoPlayer.RESTRICTED_STYLES,j)){throw new Error("You cannot set "+k+" : "+j+" CSS property for this component ")}else{this.superproto.setCSS.apply(this,[k,j,h])}};c.video.VideoPlayer.prototype.dispose=function(){this.cleanUp();if(this.obj){if(this.obj.parentElement){this.obj.parentElement.removeChild(this.obj)}}};c.video.VideoPlayer.prototype.cleanUp=function(){if(this.isReq_){this.isReq_.cancelHttpReq();this.isReq_=null}if(this.navigationReq){this.navigationReq.cancelHttpReq();this.navigationReq=null}if(this.captionReq){this.captionReq.cancelHttpReq();this.captionReq=null}if(this.interactiveDataReq){this.interactiveDataReq.cancelHttpReq();this.interactiveDataReq=null}this.methodCallQueue.splice(0,this.methodCallQueue.length);if(this.iconEffectObj){this.iconEffectObj.dispose();this.iconEffectObj=null}if(this.videoProxy){this.videoProxy.dispose()}if(this.obj){c.Event.removeDOMListener(this.obj,"click",this.onClickHandler,false);c.Event.removeDOMListener(this.obj,"click",this.onTogglePauseHandler,false);c.Event.removeDOMListener(this.obj,"touchend",this.onTouchEndHandler,false);c.Event.removeDOMListener(this.obj,"click",this.onTouchClickHandler,false)}c.Util.removeTags(this.obj);this.obj.style.cssText=""};c.video.VideoPlayer.getDurationFromItem=function(j){if(j.type==c.ItemDescType.VIDEO_SET){var h=j.items[0];if(h.userData&&h.userData.Video_Length){return parseFloat(h.userData.Video_Length)*1000}else{if((h.userData instanceof Array)&&h.userData[0].Video_Length){return parseFloat(h.userData[0].Video_Length)*1000}}}else{if(j.userData&&j.userData.Video_Length){return parseFloat(j.userData.Video_Length)*1000}else{if((j.userData instanceof Array)&&j.userData[0].Video_Length){return parseFloat(j.userData[0].Video_Length)*1000}}}return undefined};c.video.VideoPlayer.prototype.setHLSLevel=function(h){this.videoProxy.setHLSLevel(h)};c.video.VideoPlayer.prototype.showWaitIcon=function(h){if(this.waitIconObj){this.waitIconObj.style.visibility=h?"inherit":"hidden"}};c.VideoPlayer=c.video.VideoPlayer;(function b(){var l=c.Util.css.createCssRuleText;var k=c.Util.css.createCssImgUrlText;var j=c.browser&&c.browser.name=="ie"&&c.browser.version.major>=10;var h=l(".s7videoplayer",{position:"absolute",width:"400px",height:"300px","background-color":"#000000","-webkit-touch-callout":"none","-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","-ms-touch-action":j?"none":"","touch-action":j?"none":""})+l(".s7videoplayer div[role='button']",{position:"relative","z-index":"1"})+l(".s7videoplayer .s7iconeffect",{width:"120px",height:"120px","-webkit-transform":"translateZ(0px)","background-repeat":"no-repeat","background-position":"center"})+l(".s7videoplayer .s7iconeffect[state='play']",{"background-image":k("videoplayicon.png")})+l(".s7videoplayer .s7iconeffect[state='replay']",{"background-image":k("videoreplayicon.png")})+l(".s7videoplayer .s7videoposter",{top:"0px",left:"0px",position:"absolute","background-repeat":"no-repeat","background-position":"center center","background-size":"contain"})+l(".s7videoplayer .s7caption",{"font-family":"sans-serif","font-size":"large",color:"#ffffff","-webkit-transform":"translateZ(0px)",margin:"0 auto"})+l(".s7videoplayer .s7waiticon",{"background-image":k("busyicon.gif"),"background-repeat":"no-repeat","background-position":"center",position:"absolute",width:"101px",height:"29px",left:"50%",top:"50%","margin-left":"-50px","margin-top":"-15px"});c.Util.css.addDefaultCSS(h,"VideoPlayer")})()}if(!c.video.BaseVideoProxy){c.video.BaseVideoProxy=function e(t,o,s,h,u,k,j,n,m,l,r,p,q){this.serverUrl=h;this.aemmode=q;this.videoServerUrl=u;this.curTime=undefined;this.bufTime=undefined;this.serverDuration=undefined;this.videoDuration=undefined;this.fallbackmessage=p;this.volume=1;this.mutedValue=r;this.playback=j;this.progressivebitrate=n*1024;this.width=o;this.height=s;this.callQueue=[];this.proxyIsReady=false;this.loop=m;this.preload=l;this.inContainer=t;this.inAutoPlay=k;this.isDisposed=false;this.firstAsset=true;this.videoElement=null;this.createVideoElement()};c.video.BaseVideoProxy.prototype.createVideoElement=function(){if(this.videoElement){this.curTime=0;this.bufTime=0;this.serverDuration=0;this.videoDuration=0;this.inContainer.removeChild(this.videoElement);this.videoElement=null}this.videoElement=c.Util.createObj(null,"video",null,null);this.videoElement.setAttribute("tabindex",-1);if(this.mutedValue){this.videoElement.setAttribute("muted","")}this.videoElement.volume=this.volume;this.videoElement.muted=this.mutedValue;this.videoElement.style.position="absolute";this.resize(this.width,this.height);this.videoElement.preload=this.preload?"auto":"none";this.inContainer.insertBefore(this.videoElement,this.inContainer.firstChild);if(this.inAutoPlay){this.videoElement.autoplay=true}if(this.playback.controls){this.videoElement.controls=true}else{if(("ipad"==c.browser.device.name)||(("blackberry"==c.browser.device.name)&&(c.browser.device.version==10))){this.videoElement.setAttribute("webkit-playsinline",1)}}if(this.loop){this.videoElement.loop=true}this.addVideoElementEventListeners()};c.video.BaseVideoProxy.prototype.addVideoElementEventListeners=function(){var h=this;c.Event.addDOMListener(this.videoElement,"timeupdate",function(){if(h.isDisposed){return}var j=h.curTime;h.curTime=h.videoElement.currentTime;if(h.videoElement.ended&&(h.videoDuration!=h.curTime)){h.curTime=h.videoDuration}if(j!=h.curTime){h.onCurrentTime()}},true);c.Event.addDOMListener(this.videoElement,"loadstart",function(){if(h.isDisposed){return}h.onLoadProgress()},true);c.Event.addDOMListener(this.videoElement,"canplay",function(){if(h.isDisposed){return}h.isbuffering=false;h.onBuffering(false)},true);c.Event.addDOMListener(this.videoElement,"waiting",function(){if(h.isDisposed){return}h.isbuffering=true;h.onBuffering(true)},true);c.Event.addDOMListener(this.videoElement,"loadedmetadata",function(){if(h.isDisposed){return}if(!h.videoWidth&&!h.videoHeight){h.videoWidth=this.videoWidth;h.videoHeight=this.videoHeight;h.resize(h.getWidth(),h.getHeight())}h.proxyIsReady=true;while(h.callQueue.length>0){var j=h.callQueue[0];h.callQueue.splice(0,1);h[j.func].apply(h,j.args)}h.onLoadProgress()},true);c.Event.addDOMListener(this.videoElement,"progress",function(){if(h.isDisposed){return}h.onLoadProgress()},true);c.Event.addDOMListener(this.videoElement,"durationchange",function(){if(h.isDisposed){return}var j=h.videoElement.duration;if(("android"==c.browser.device.name)&&(4==c.browser.device.version)&&(h.videoElement.readyState<4)){return}if((c.browser.name=="safari")&&(h.serverDuration)&&((j==Math.floor(h.serverDuration))||(j==Math.ceil(h.serverDuration)))){j=h.serverDuration}if(j!=h.videoDuration){h.videoDuration=j;h.onDuration()}},true);c.Event.addDOMListener(this.videoElement,"volumechange",function(){if(h.isDisposed){return}h.onVolume()},true);c.Event.addDOMListener(this.videoElement,"seeked",function(){if(h.isDisposed){return}if(c.browser.name=="ie"){h.isbuffering=false;h.onBuffering(false)}h.onSeeked()},true);c.Event.addDOMListener(this.videoElement,"play",function(){if(h.isDisposed){return}h.onStateChange()},true);c.Event.addDOMListener(this.videoElement,"pause",function(){if(h.isDisposed){return}h.onStateChange()},true);c.Event.addDOMListener(this.videoElement,"ended",function(){if(h.isDisposed){return}if(h.videoDuration!=h.curTime){h.curTime=h.videoDuration}h.onCurrentTime();h.onStateChange()},true);c.Event.addDOMListener(this.videoElement,"loadeddata",function(){if(h.isDisposed){return}h.onViewReady()},true)};c.video.BaseVideoProxy.prototype.getVolume=function(){return this.videoElement.volume};c.video.BaseVideoProxy.prototype.setVolume=function(h){if(this.videoElement.muted){this.mutedValue=this.videoElement.muted=false}this.volume=h;this.videoElement.volume=h};c.video.BaseVideoProxy.prototype.mute=function(h){this.mutedValue=this.videoElement.muted=h};c.video.BaseVideoProxy.prototype.muted=function(){return this.videoElement.muted};c.video.BaseVideoProxy.prototype.getLoadedPosition=function(){return((this.videoElement.buffered&&this.videoElement.buffered.length>0)?this.videoElement.buffered.end(0)*1000:0)};c.video.BaseVideoProxy.prototype.getDuration=function(){if(c.Util.isNull(this.videoDuration)){return undefined}else{return this.videoDuration*1000}};c.video.BaseVideoProxy.prototype.ended=function(){return this.videoElement.ended};c.video.BaseVideoProxy.prototype.getWidth=function(){return this.width};c.video.BaseVideoProxy.prototype.getHeight=function(){return this.height};c.video.BaseVideoProxy.prototype.play=function(){this.videoElement.play()};c.video.BaseVideoProxy.prototype.paused=function(){return this.videoElement.paused};c.video.BaseVideoProxy.prototype.pause=function(){if(this.isbuffering){this.isbuffering=false;this.onBuffering(false)}this.videoElement.pause()};c.video.BaseVideoProxy.prototype.getCurrentTime=function(){return this.curTime*1000};c.video.BaseVideoProxy.prototype.dispose=function(){if(this.videoElement){this.videoElement.pause();this.videoElement.removeAttribute("src");this.videoElement.load();if(this.videoElement.parentElement){this.videoElement.parentElement.removeChild(this.videoElement)}}this.isDisposed=true};c.video.BaseVideoProxy.prototype.resize=function(j,k){var h,l;this.width=j;this.height=k;if(this.videoHeight&&this.videoWidth){h=j*this.videoHeight/this.videoWidth;if(h>k){l=this.videoWidth*k/this.videoHeight;h=k}else{l=j}}else{h=k;l=j}this.videoElement.width=l*c.browser.device.pixelratio;this.videoElement.height=h*c.browser.device.pixelratio;this.videoElement.style.width=l+"px";this.videoElement.style.height=h+"px";this.videoElement.style.left=(j-l)/2+"px";this.videoElement.style.top=(k-h)/2+"px"};c.video.BaseVideoProxy.prototype.seek=function(j){if(!this.proxyIsReady){this.fillMethodQueue("seek",[j]);return}var h=(!this.videoElement.paused);this.videoElement.currentTime=j/1000;this.curTime=j/1000;if((c.browser.device.name=="ipad")&&(c.browser.device.version==6)&&j==0){if(h){this.videoElement.play()}}};c.video.BaseVideoProxy.prototype.onLoadProgress=function(){};c.video.BaseVideoProxy.prototype.onCurrentTime=function(){};c.video.BaseVideoProxy.prototype.onDuration=function(){};c.video.BaseVideoProxy.prototype.onSeeked=function(){};c.video.BaseVideoProxy.prototype.onVolume=function(){};c.video.BaseVideoProxy.prototype.onStateChange=function(){};c.video.BaseVideoProxy.prototype.onViewReady=function(){};c.video.BaseVideoProxy.prototype.fillMethodQueue=function(j,h){this.callQueue.push({func:j,args:h})}}if(!c.video.HTML5VideoProxy){c.video.HTML5VideoProxy=function g(s,o,r,h,u,k,j,n,m,l,t,p,q){c.Logger.log(c.Logger.INFO,"HTML5VideoProxy constructor");arguments.callee.superclass.apply(this,[s,o,r,h,u,k,j,n,m,l,t,p,q])};c.Class.inherits("s7sdk.video.HTML5VideoProxy","s7sdk.video.BaseVideoProxy");c.video.HTML5VideoProxy.prototype.setVideo=function(j,h){this.callQueue.splice(0,this.callQueue.length);this.proxyIsReady=false;var n;if(this.firstAsset){this.firstAsset=false}else{this.createVideoElement()}var m=this;if(h!=null){this.videoElement.poster=h;var l=new Image();c.Event.addDOMListener(l,"load",function(){m.onViewReady()},true);l.src=h}while(this.videoElement.firstChild){this.videoElement.removeChild(this.videoElement.firstChild)}var k=document.createElement("p");k.innerText=this.fallbackmessage;this.videoElement.appendChild(k);var o=document.createElement("source");o.src=j;this.videoElement.appendChild(o);this.resize(this.width,this.height)};c.video.HTML5VideoProxy.prototype.setAsset=function(j,h){this.callQueue.splice(0,this.callQueue.length);this.proxyIsReady=false;this.serverDuration=c.video.VideoPlayer.getDurationFromItem(j)/1000;if(this.serverDuration){this.videoDuration=this.serverDuration}var p=c.MediaSetParser.resolveVideoAsset(j,this.playback,this.progressivebitrate,this.aemmode,this.videoServerUrl);if(j.items){this.videoWidth=j.items[0].width;this.videoHeight=j.items[0].height}else{if(j.width){this.videoWidth=j.width;this.videoHeight=j.height}}if(this.firstAsset){this.firstAsset=false}else{this.createVideoElement()}var n=this;if(h!=null){this.videoElement.poster=c.Util.resolveURL(this.serverUrl,h);var m=new Image();c.Event.addDOMListener(m,"load",function(){n.onViewReady()},true);m.src=c.Util.resolveURL(this.serverUrl,h)}var l;if(c.Util.isArray(p)){l=[];for(i=0;i<p.length;i++){l[i]=c.Util.resolveURL(this.videoServerUrl,p[i])}}else{l=c.Util.resolveURL(this.videoServerUrl,p)}while(this.videoElement.firstChild){this.videoElement.removeChild(this.videoElement.firstChild)}var k=document.createElement("p");k.innerText=this.fallbackmessage;this.videoElement.appendChild(k);var o;if(c.Util.isArray(l)){for(i=0;i<l.length;i++){o=document.createElement("source");o.src=l[i];this.videoElement.appendChild(o)}}else{o=document.createElement("source");o.src=l;this.videoElement.appendChild(o)}this.resize(this.width,this.height)};c.video.HTML5VideoProxy.prototype.setHLSLevel=function(h){}}if(!c.video.IPhoneProxy){c.video.IPhoneProxy=function f(s,o,r,h,u,k,j,n,m,l,t,p,q){c.Logger.log(c.Logger.INFO,"IPhoneProxy constructor");arguments.callee.superclass.apply(this,[s,o,r,h,u,k,j,n,m,l,t,p,q]);this.createPosterElement(o,r)};c.Class.inherits("s7sdk.video.IPhoneProxy","s7sdk.video.BaseVideoProxy");c.video.IPhoneProxy.prototype.createVideoElement=function(){if(this.videoElement){this.inContainer.removeChild(this.videoElement);this.videoElement=null}this.videoElement=c.Util.createObj(null,"video",null,null);this.videoElement.preload=this.preload?"auto":"none";this.videoElement.setAttribute("tabindex",-1);if(this.mutedValue){this.videoElement.setAttribute("muted","")}if(this.inAutoPlay){this.videoElement.autoplay=true}this.videoElement.muted=this.mutedValue;this.videoElement.style.position="absolute";this.isCanPlaysInline=c.browser.device.version>=10;if(this.isCanPlaysInline){this.videoElement.setAttribute("playsinline",1)}else{this.videoElement.style.width="1px";this.videoElement.style.height="1px"}var h=document.createElement("p");h.innerText=this.fallbackmessage;this.videoElement.appendChild(h);if(this.loop){this.videoElement.loop=true}this.inContainer.insertBefore(this.videoElement,this.inContainer.firstChild);this.addVideoElementEventListeners()};c.video.IPhoneProxy.prototype.createPosterElement=function(h,j){if(!this.isCanPlaysInline){if(this.divPosterElement){this.inContainer.removeChild(this.divPosterElement)}this.divPosterElement=c.Util.createObj(null,"div",null,null);this.divPosterElement.className="s7videoposter";this.divPosterElement.style.width=h+"px";this.divPosterElement.style.height=j+"px";this.inContainer.insertBefore(this.divPosterElement,this.videoElement)}};c.video.IPhoneProxy.prototype.setAsset=function(k,h){var n=c.MediaSetParser.resolveVideoAsset(k,this.playback,this.progressivebitrate,this.aemmode,this.videoServerUrl);this.serverDuration=c.video.VideoPlayer.getDurationFromItem(k)/1000;if(this.serverDuration){this.videoDuration=this.serverDuration}if(this.firstAsset){this.firstAsset=false}else{this.createPosterElement(this.width,this.height);this.createVideoElement()}var j=this;c.Event.addDOMListener(this.videoElement,"webkitendfullscreen",function(o){j.onStateChange()},false);if(h!=null&&this.divPosterElement){this.divPosterElement.style.backgroundImage="url('"+c.Util.resolveURL(this.serverUrl,h)+"')"}var l;if(c.Util.isArray(n)){l=[];for(i=0;i<n.length;i++){l[i]=c.Util.resolveURL(this.videoServerUrl,n[i])}}else{l=c.Util.resolveURL(this.videoServerUrl,n)}while(this.videoElement.firstChild){this.videoElement.removeChild(this.videoElement.firstChild)}var m;if(c.Util.isArray(l)){for(i=0;i<l.length;i++){m=document.createElement("source");m.src=l[i];this.videoElement.appendChild(m)}}else{m=document.createElement("source");m.src=l;this.videoElement.appendChild(m)}if(h!=null&&!this.divPosterElement){this.videoElement.poster=c.Util.resolveURL(this.serverUrl,h)}this.resize(this.width,this.height);if(this.preload){this.videoElement.load()}};c.video.IPhoneProxy.prototype.setVideo=function(l,h){if(this.firstAsset){this.firstAsset=false}else{this.createPosterElement(this.width,this.height);this.createVideoElement()}var j=this;c.Event.addDOMListener(this.videoElement,"webkitendfullscreen",function(m){j.onStateChange()},false);if(this.divPosterElement){this.divPosterElement.style.backgroundImage=h?"url('"+h+"')":"none"}while(this.videoElement.firstChild){this.videoElement.removeChild(this.videoElement.firstChild)}var k=document.createElement("source");k.src=l;this.videoElement.appendChild(k);if(!this.divPosterElement){this.videoElement.poster=h?h:""}this.resize(this.width,this.height);if(this.preload){this.videoElement.load()}};c.video.IPhoneProxy.prototype.getVolume=function(){return 1};c.video.IPhoneProxy.prototype.setVolume=function(h){};c.video.IPhoneProxy.prototype.mute=function(h){};c.video.IPhoneProxy.prototype.setHLSLevel=function(h){};c.video.IPhoneProxy.prototype.resize=function(j,k){this.width=j;this.height=k;if(this.isCanPlaysInline){var h,l;this.width=j;this.height=k;if(this.videoHeight&&this.videoWidth){h=j*this.videoHeight/this.videoWidth;if(h>k){l=this.videoWidth*k/this.videoHeight;h=k}else{l=j}}else{h=k;l=j}this.videoElement.width=l*c.browser.device.pixelratio;this.videoElement.height=h*c.browser.device.pixelratio;this.videoElement.style.width=l+"px";this.videoElement.style.height=h+"px";this.videoElement.style.left=(j-l)/2+"px";this.videoElement.style.top=(k-h)/2+"px"}if(this.divPosterElement){this.divPosterElement.style.width=j+"px";this.divPosterElement.style.height=k+"px"}};c.video.IPhoneProxy.prototype.seek=function(h){this.videoElement.currentTime=h/1000};c.video.IPhoneProxy.prototype.dispose=function(){if(this.divPosterElement){this.inContainer.removeChild(this.divPosterElement);this.divPosterElement=null}this.superclass.prototype.dispose.apply(this)}}if(!c.video.HLSVideoProxy){c.video.HLSVideoProxy=function a(u,q,t,h,w,k,j,n,p,m,l,v,r,s){c.Util.require("s7sdk.libs.hls.hls");arguments.callee.superclass.apply(this,[u,q,t,h,w,k,j,n,m,l,v,r,s]);c.Logger.log(c.Logger.INFO,"HLSVideoProxy constructor");this.hlsPlayer=null;this.mediaResource=null;this.videoView=null;this.initialbitrate=p*1024;var o=this;this.loadHlsJsAndCreatePlayer=function(){if(c.Hls){o.createHLSPlayer();clearTimeout(o.hlsjsLoadTimer);o.hlsjsLoadTimer=null}else{if(o.hlsjsLoadTimer){clearTimeout(o.hlsjsLoadTimer);o.hlsjsLoadTimer=null}o.hlsjsLoadTimer=setTimeout(o.loadHlsJsAndCreatePlayer,100)}};this.loadHlsJsAndCreatePlayer()};c.Class.inherits("s7sdk.video.HLSVideoProxy","s7sdk.video.BaseVideoProxy");c.video.HLSVideoProxy.prototype.createHLSPlayer=function(k){if(this.hlsPlayer){this.curTime=0;this.bufTime=0;this.serverDuration=0;this.videoDuration=0;this.hlsPlayer.destroy();this.hlsPlayer=null;delete this.hlsPlayer}var h={fragLoadingTimeOut:60000,maxBufferSize:30*1000*1000};if(c.Hls){this.hlsPlayer=new c.Hls(h);this.hlsPlayer.on(c.Hls.Events.MEDIA_ATTACHED,function(){c.Logger.log(c.Logger.FINE,"HLSVideoProxy: Hls.Events.MEDIA_ATTACHED - Media attached !")});this.hlsPlayer.on(c.Hls.Events.MANIFEST_LOADING,function(l,m){c.Logger.log(c.Logger.FINE,"HLSVideoProxy: Hls.Events.MANIFEST_LOADING Manifest=%0",m.url)});this.hlsPlayer.on(c.Hls.Events.MANIFEST_LOADED,function(l,m){c.Logger.log(c.Logger.FINE,"HLSVideoProxy: Hls.Events.MANIFEST_LOADED Manifest data levels=%0",m.levels.length)});this.hlsPlayer.on(c.Hls.Events.MANIFEST_PARSED,function(m,n){c.Logger.log(c.Logger.FINE,"HLSVideoProxy: Hls.Events.MANIFEST_PARSED Found %0 quality levels",n.levels.length);for(var l=0;l<n.levels.length;l++){c.Logger.log(c.Logger.FINE,"HLSVideoProxy: * %0 quality level  bitrate=%1",l,n.levels[l].bitrate)}});this.hlsPlayer.on(c.Hls.Events.LEVEL_SWITCH,function(l,m){c.Logger.log(c.Logger.FINE,"HLSVideoProxy: Hls.Events.LEVEL_SWITCH Level switched! Current level =%0",m.level)});this.hlsPlayer.on(c.Hls.Events.FRAG_CHANGED,function(l,m){c.Logger.log(c.Logger.FINE,"HLSVideoProxy: Hls.Events.FRAG_CHANGED Fragment changed! Current fragment number =%0; fragment's level =%1; fragment's url =%2",m.frag.sn,m.frag.level,m.frag.url)});this.hlsPlayer.on(c.Hls.Events.FRAG_LOADING,function(l,m){c.Logger.log(c.Logger.FINE,"HLSVideoProxy: Hls.Events.FRAG_LOADING Fragment loading! Current fragment number =%0; fragment's level =%1; fragment's url =%2",m.frag.sn,m.frag.level,m.frag.url)});this.hlsPlayer.on(c.Hls.Events.FRAG_LOADED,function(l,m){c.Logger.log(c.Logger.FINE,"HLSVideoProxy: Hls.Events.FRAG_LOADED Fragment loaded! Current fragment number =%0; fragment's level =%1; fragment's url =%2; length=%3",m.frag.sn,m.frag.level,m.frag.url,m.stats.length)});this.hlsPlayer.on(c.Hls.Events.FRAG_PARSING_METADATA,function(l,m){c.Logger.log(c.Logger.FINE,"HLSVideoProxy: Hls.Events.FRAG_PARSING_METADATA Parsing id3 is completed! Demuxer id =%0",m.id)});this.hlsPlayer.on(c.Hls.Events.FRAG_PARSING_DATA,function(l,m){c.Logger.log(c.Logger.FINE,"HLSVideoProxy: Hls.Events.FRAG_PARSING_DATA Parsing id3 is completed! Number of samples =%0; type  =%1;  PTS of first sample =%2; PTS of last sample =%2; DTS of first sample =%4; DTS of last sample =%5",m.nb,m.type,m.startPTS,m.endPTS,m.startDTS,m.endDTS)})}while(this.callQueue.length>0){var j=this.callQueue[0];this.callQueue.splice(0,1);this[j.func].apply(this,j.args)}};c.video.HLSVideoProxy.prototype.setVideo=function(j,h){this.callQueue.splice(0,this.callQueue.length);this.proxyIsReady=false;var m;if(this.firstAsset){this.firstAsset=false}else{this.createHLSPlayer()}var l=this;if(h!=null){this.videoElement.poster=h;var k=new Image();c.Event.addDOMListener(k,"load",function(){l.onViewReady()},true);k.src=h}else{this.videoElement.poster=""}if(this.hlsPlayer){this.hlsPlayer.startLevel=d(j,this.initialbitrate);this.hlsPlayer.attachMedia(this.videoElement);if(this.preload||this.inAutoPlay){this.hlsPlayer.loadSource(j);this.preloaded=true}else{this.preloaded=false;this.item=j}}else{this.fillMethodQueue("setVideo",[j,h])}this.resize(this.width,this.height)};c.video.HLSVideoProxy.prototype.play=function(){if(!this.preloaded){this.preloaded=true;this.hlsPlayer.loadSource(this.item)}this.videoElement.play()};function d(l,k){if(l!=null&&l.items){var p=l.items;if(typeof(p.filter)!="undefined"){p=p.filter(function(r,s,q){return q.map(function(t){return t.bitrate}).indexOf(r.bitrate)===s})}if(p.length>1){p.sort(function(r,q){return r.bitrate-q.bitrate});var o=0;var n=false;for(var h=p.length-1;h>0;h--){var j=p[h];if(j.bitrate<=k){o=h;n=true;break}}var m=n?o:0;return m}else{return 0}}else{return -1}}c.video.HLSVideoProxy.prototype.setAsset=function(j,h){this.callQueue.splice(0,this.callQueue.length);this.proxyIsReady=false;if(!this.videoElement){this.createVideoElement()}if(this.firstAsset){this.firstAsset=false}else{this.createHLSPlayer()}var n=c.MediaSetParser.resolveVideoAsset(j,this.playback,this.progressivebitrate,this.aemmode,this.videoServerUrl);var m=c.Util.resolveURL(this.videoServerUrl,n);if(this.hlsPlayer){this.hlsPlayer.startLevel=d(j,this.initialbitrate);this.hlsPlayer.streamController.fragBitrateTest=true;if(this.preload||this.inAutoPlay){this.hlsPlayer.loadSource(m);this.preloaded=true}else{this.preloaded=false;this.item=m}this.hlsPlayer.attachMedia(this.videoElement)}else{this.fillMethodQueue("setAsset",[j,h])}var l=this;if(h!=null){this.videoElement.poster=c.Util.resolveURL(this.serverUrl,h);var k=new Image();c.Event.addDOMListener(k,"load",function(){l.onViewReady()},true);k.src=c.Util.resolveURL(this.serverUrl,h)}else{this.videoElement.poster=""}this.resize(this.width,this.height)};c.video.HLSVideoProxy.prototype.dispose=function(){if(this.hlsjsLoadTimer){clearTimeout(this.hlsjsLoadTimer);this.hlsjsLoadTimer=null}if(this.hlsPlayer){this.hlsPlayer.destroy()}this.superclass.prototype.dispose.apply(this)};c.video.HLSVideoProxy.prototype.setHLSLevel=function(h){if(this.hlsPlayer){this.hlsPlayer.loadLevel=h}}}})(s7getCurrentNameSpace());