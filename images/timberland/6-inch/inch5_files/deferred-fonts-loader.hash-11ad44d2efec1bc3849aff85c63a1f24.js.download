define(["require","jquery","domReady","pubsub"],function(t,i,n){function o(t,n,o){this.element=i(t),this.options=n,this.metadata=i(this.element).data("fontloader-options")}var e="fontLoader";o.defaults=(o.prototype={defaults:{fontList:"/_jcr_content.fonts.json"},init:function(){console.debug("Initializing deferred font loading.");var t=this;t.config=i.extend({},t.defaults,t.options,t.metadata);var n=window&&window.currentPath?window.currentPath:"/homepage";return t.config.fontList=n+t.config.fontList,t.getFontList(),t},loadFonts:function(){var o=this;t(["fontfaceobserver"],function(t){var n=o.config.fontList.map(function(t){return new FontFaceObserver(t.font)});Promise.all(n.map(function(t){return t.load()})).then(function(){i("html").addClass("fonts-loaded"),i.pubsub("publish","vfdp.fonts.loaded")},function(t){console.error("Error loading font",t),i.pubsub("publish","vfdp.fonts.error",t)})})},getFontList:function(){var e=this;i.ajax({url:e.config.fontList,dataType:"json",type:"GET",error:function(t,n,o){console.error("Deferred webfonts failed to load with error: ",n,o),i.pubsub("publish","vfdp.fonts.error",err)},success:function(t){var n,o=[];for(n in t)n.deferredLoading&&o.push(n);e.config.fontList=o,e.loadFonts()}})}}).defaults,i.fn.fontLoader=function(n){return this.each(function(){var t=i(this).data(e);t||(t=new o(this,n).init(),i(this).data(e,t))})}});
//# sourceMappingURL=../../maps/js/shared/deferred-fonts-loader.hash-b8ca23f41db97dfac485fac686b1c971.js.map